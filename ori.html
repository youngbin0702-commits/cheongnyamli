<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>청냠리 | 최종 MVP 데모</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- QRCode.js for generating QR codes -->
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

    <style>
        /* 기본 스타일 및 애니메이션 */
        body { font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        .screen { display: none; padding-bottom: 80px; /* 하단 네비게이션을 위한 여백 */ }
        .screen.active { display: block; animation: fadeIn .3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1, transform: translateY(0); } }
        
        /* UI 컴포넌트 스타일 */
        .filter-active { background: #374151; color: #fff; border-color: #374151; }
        .vh-safe { min-height: 100svh; /* Safe area 뷰포트 높이 */ }
        
        /* 하단 네비게이션 */
        .bottom-nav { box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }
        .nav-btn.active { color: #4f46e5; }

        /* 카카오톡 플로팅 액션 버튼 */
        .fab-kakao {
            position: fixed;
            bottom: 100px;
            right: 20px;
            z-index: 50;
            width: 60px;
            height: 60px;
            background-color: #FEE500;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease-in-out;
        }
        .fab-kakao:hover { transform: scale(1.05); }
        .fab-kakao-text { font-weight: 900; color: #191919; font-size: 14px; }

        /* 모달 스타일 */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5); display: flex;
            justify-content: center; align-items: center; z-index: 100;
        }
        .modal-content {
            background: white; padding: 1.5rem; border-radius: 1rem;
            max-width: 90%; width: 400px;
            animation: fadeIn .3s ease-in-out;
        }

        /* 검색 결과 카드 스타일 */
        .search-store-item {
            background-color: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease-in-out;
            cursor: pointer;
        }
        .search-store-item:hover {
            transform: translateY(-4px);
        }
        
        /* 헤더 로고 그라디언트 */
        .logo-gradient {
            background: linear-gradient(to right, #2dd4bf, #4f46e5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* 토스트 알림 스타일 */
        .toast {
            background-color: rgba(0, 0, 0, 0.75);
            color: white;
            padding: 12px 20px;
            border-radius: 9999px;
            font-size: 14px;
            animation: toastIn .3s ease-in-out, toastOut .3s ease-in-out 2.7s;
        }
        @keyframes toastIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes toastOut { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(20px); } }
    </style>
</head>
<body class="bg-gray-100 flex justify-center">
    <div id="appContainer" class="max-w-lg w-full bg-white vh-safe shadow-2xl relative">

        <!-- ==================== HOME SCREEN ==================== -->
        <div id="homeScreen" class="screen active">
            <header class="p-4 sticky top-0 bg-white z-10 shadow-sm">
                <div class="flex justify-between items-center mb-4">
                    <h1 class="text-2xl font-bold">
                        <span class="logo-gradient">청냠리</span>
                    </h1>
                    <div class="flex items-center space-x-4 text-gray-600">
                        <button onclick="showScreen('searchScreen')"><i class="ph ph-magnifying-glass text-2xl"></i></button>
                        <button onclick="showNotificationModal()" class="relative">
                            <i class="ph ph-bell text-2xl"></i>
                            <span id="notification-dot" class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full hidden"></span>
                        </button>
                        <!-- 수정: 장바구니 아이콘 래퍼 및 카운트 추가 -->
                        <button onclick="showCartModal()" class="relative">
                            <i class="ph ph-shopping-cart text-2xl"></i>
                            <span id="cart-item-count" class="absolute -top-1 -right-2 bg-indigo-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                        </button>
                    </div>
                </div>
                <div onclick="showScreen('searchScreen')" class="relative w-full pl-4 pr-4 py-3 bg-gray-100 border-transparent rounded-lg cursor-pointer flex items-center text-gray-500">
                    <i class="ph ph-magnifying-glass text-xl mr-2"></i>
                    <span>가게 이름이나 상품을 검색해보세요!</span>
                </div>
            </header>

            <!-- Main Navigation -->
            <nav class="p-4 grid grid-cols-4 gap-4 text-center">
                <button onclick="showScreen('mapScreen')" class="nav-button flex flex-col items-center justify-center space-y-2 p-2 rounded-lg hover:bg-indigo-50 transition-colors">
                    <div class="nav-icon w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center">
                        <i class="ph ph-map-trifold text-3xl text-indigo-600"></i>
                    </div>
                    <span class="font-semibold text-gray-700 text-sm">시장 지도</span>
                </button>
                <button onclick="showScreen('categoryListScreen', 'all')" class="nav-button flex flex-col items-center justify-center space-y-2 p-2 rounded-lg hover:bg-orange-50 transition-colors">
                    <div class="nav-icon w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center"><i class="ph ph-storefront text-3xl text-orange-600"></i></div>
                    <span class="font-semibold text-gray-700 text-sm">가게/상품</span>
                </button>
                <button onclick="showScreen('pickupScreen')" class="nav-button flex flex-col items-center justify-center space-y-2 p-2 rounded-lg hover:bg-teal-50 transition-colors">
                    <div class="nav-icon w-16 h-16 bg-teal-100 rounded-full flex items-center justify-center"><i class="ph ph-qr-code text-3xl text-teal-600"></i></div>
                    <span class="font-semibold text-gray-700 text-sm">픽업 주문</span>
                </button>
                <button onclick="showScreen('smartShoppingScreen')" class="nav-button flex flex-col items-center justify-center space-y-2 p-2 rounded-lg hover:bg-sky-50 transition-colors">
                    <div class="nav-icon w-16 h-16 bg-sky-100 rounded-full flex items-center justify-center"><i class="ph ph-chats-circle text-3xl text-sky-600"></i></div>
                    <span class="font-semibold text-gray-700 text-sm">스마트 장보기</span>
                </button>
            </nav>

            <hr class="my-2 border-gray-100 border-4">

            <!-- Category Section -->
            <section class="p-4">
                <h2 class="text-lg font-bold text-gray-800 mb-4">어떤 종류를 찾으세요?</h2>
                <div id="category-shortcut-container" class="grid grid-cols-5 gap-4 text-center">
                    <!-- 카테고리 바로가기는 스크립트에서 동적으로 생성됩니다 -->
                </div>
            </section>
        </div>

        <!-- ==================== SEARCH SCREEN ==================== -->
        <div id="searchScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center">
                    <button onclick="showScreen('homeScreen')" class="p-2 mr-2"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <div class="relative flex-1">
                        <input type="text" id="searchInput" placeholder="가게 이름이나 상품을 검색해보세요!"
                               class="w-full pl-10 pr-4 py-3 bg-gray-100 border-transparent rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <i class="ph ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xl"></i>
                    </div>
                </div>
            </header>
            <main id="searchResultsContainer" class="p-4 space-y-4"></main>
        </div>
        
        <!-- ==================== CATEGORY LIST SCREEN ==================== -->
        <div id="categoryListScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center">
                    <button onclick="showScreen('homeScreen')" class="p-2 mr-2"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 id="categoryTitle" class="text-xl font-bold text-gray-800"></h1>
                </div>
            </header>
            <div class="p-4 flex items-center space-x-2 border-b overflow-x-auto">
                <i class="ph ph-faders-horizontal text-xl text-gray-600"></i>
                <button class="category-sort-btn px-4 py-2 text-sm font-semibold border rounded-full filter-active whitespace-nowrap" data-sort="default">기본 순</button>
                <button class="category-sort-btn px-4 py-2 text-sm font-semibold border rounded-full whitespace-nowrap" data-sort="orders">주문 많은 순</button>
                <button class="category-sort-btn px-4 py-2 text-sm font-semibold border rounded-full whitespace-nowrap" data-sort="rating">별점 높은 순</button>
            </div>
            <main id="categoryStoreListContainer" class="p-4 space-y-4"></main>
        </div>

        <!-- ==================== STORE DETAIL SCREEN ==================== -->
        <div id="storeDetailScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center">
                    <button id="backToCategoryBtn" class="p-2 mr-2"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 id="storeDetailTitle" class="text-xl font-bold text-gray-800 flex-1"></h1>
                    <div id="favoriteButtonsContainer" class="ml-auto"></div>
                </div>
            </header>
            <main class="p-4">
                <div id="storeDetailInfo" class="mb-6"></div>
                <hr>
                <h2 class="text-lg font-bold text-gray-800 my-4">상품 목록</h2>
                <div id="storeProductListContainer" class="space-y-4"></div>
                <hr>
                <h2 class="text-lg font-bold text-gray-800 my-4">방문자 리뷰</h2>
                <div id="storeReviewsContainer" class="space-y-4"></div>
            </main>
        </div>

        <!-- ==================== SMART SHOPPING SCREEN ==================== -->
        <div id="smartShoppingScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center mb-4">
                    <button onclick="showScreen('homeScreen')" class="p-2 mr-2"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 class="text-xl font-bold text-gray-800">스마트 장보기</h1>
                </div>
                 <div class="relative">
                    <input id="smartSearchInput" type="text" placeholder="예: 고등어, 삼겹살, 김치"
                           class="w-full pl-10 pr-4 py-3 bg-gray-100 border-transparent rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <i class="ph ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xl"></i>
                </div>
            </header>
            <main class="p-4">
                <div id="myRecipesContainer" class="mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <h2 class="text-lg font-bold text-gray-800">나만의 레시피</h2>
                        <button onclick="showRecipeModal()" class="text-sm bg-indigo-100 text-indigo-700 font-semibold px-3 py-1 rounded-lg">+ 새 레시피 추가</button>
                    </div>
                    <div id="myRecipesList" class="space-y-2"></div>
                </div>
                <hr class="my-4">
                <div id="smartSearchResultsContainer"></div>
            </main>
        </div>

        <!-- ==================== RECIPE MODAL SCREEN ==================== -->
        <div id="recipeModalScreen" class="screen bg-gray-50">
             <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center">
                    <button onclick="showScreen('smartShoppingScreen')" class="p-2 mr-2"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 id="recipeModalTitle" class="text-xl font-bold text-gray-800">새 레시피 추가</h1>
                </div>
            </header>
            <main class="p-4">
                <input type="hidden" id="recipeIdInput">
                <div class="mb-4">
                    <label for="recipeNameInput" class="block text-sm font-medium text-gray-700 mb-1">레시피 이름</label>
                    <input type="text" id="recipeNameInput" placeholder="예: 우리집 김치찌개" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <h3 class="font-semibold mb-2">재료 목록</h3>
                <div id="recipeIngredientsContainer" class="space-y-2">
                    <!-- Ingredient fields will be added here -->
                </div>
                <button id="addIngredientBtn" class="w-full mt-2 text-sm text-indigo-600 font-semibold p-2 bg-indigo-50 rounded-lg hover:bg-indigo-100">
                    + 재료 추가하기
                </button>
                <div class="mt-8 flex space-x-2">
                    <button id="deleteRecipeBtn" class="w-full px-4 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 hidden">삭제</button>
                    <button id="saveRecipeBtn" class="w-full px-4 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700">저장하기</button>
                </div>
            </main>
        </div>


        <!-- ==================== PICKUP ORDER SCREEN (QR CODES) ==================== -->
        <div id="pickupScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center">
                    <button onclick="showScreen('homeScreen')" class="p-2 mr-2"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 class="text-xl font-bold text-gray-800">픽업 주문 확인</h1>
                </div>
            </header>
            <main class="p-6"></main>
        </div>
        
        <!-- ==================== MY ORDERS SCREEN (HISTORY) ==================== -->
        <div id="myOrdersScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center relative">
                    <button onclick="showScreen('homeScreen')" class="p-2 absolute left-0"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-1">주문 내역</h1>
                </div>
            </header>
            <main class="p-4 space-y-4"></main>
        </div>


        <!-- ==================== RECENTLY VIEWED & FAVORITES SCREENS ==================== -->
        <div id="recentStoresScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center relative">
                    <button onclick="showScreen('homeScreen')" class="p-2 absolute left-0"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-1">최근 본 가게</h1>
                </div>
            </header>
            <main class="p-4 space-y-4"></main>
        </div>
        <div id="favoritesScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center relative">
                    <button onclick="showScreen('homeScreen')" class="p-2 absolute left-0"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-1">관심 가게</h1>
                </div>
            </header>
            <main class="p-4 space-y-4"></main>
        </div>


        <!-- ==================== MARKET MAP SCREEN (iframe) ==================== -->
        <div id="mapScreen" class="screen">
            <header class="p-4 sticky top-0 bg-white z-10 border-b">
                <div class="flex items-center">
                    <button onclick="showScreen('homeScreen')" class="p-2 mr-2"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h1 class="text-xl font-bold text-gray-800">시장 지도</h1>
                    <div class="ml-auto flex items-center gap-2">
                        <button onclick="showPromptBox('URL 설정', '시장 지도 URL을 입력하세요', setMarketMapUrl)" class="px-3 py-1.5 rounded-md border text-sm text-gray-700 hover:bg-gray-50">URL 설정</button>
                        <a id="openMapNewTab" target="_blank" rel="noopener" class="px-3 py-1.5 rounded-md bg-indigo-600 text-white text-sm hover:bg-indigo-700">새 탭</a>
                    </div>
                </div>
            </header>

            <div id="mapLoading" class="p-6 flex items-center justify-center text-gray-500">
                <i class="ph ph-circle-notch animate-spin text-2xl mr-2"></i> 로딩 중…
            </div>

            <iframe id="marketMapFrame" title="시장 지도"
                    class="w-full" style="border:0; height: calc(100svh - 65px - 80px); display:none;"
                    referrerpolicy="no-referrer-when-downgrade" allowfullscreen></iframe>
        </div>
        
        <!-- ==================== MODAL CONTAINER ==================== -->
        <div id="modalContainer"></div>
        
        <!-- NEW: Toast Notification Container -->
        <div id="toast-container" class="fixed bottom-24 left-1/2 -translate-x-1/2 z-[101] space-y-2 w-full max-w-lg px-4"></div>

        <!-- ==================== KAKAO FAB ==================== -->
        <a href="https://pf.kakao.com/_xgGdxmn" target="_blank" class="fab-kakao">
             <span class="fab-kakao-text">TALK</span>
        </a>

        <!-- ==================== BOTTOM NAVIGATION ==================== -->
        <!-- 수정: grid-cols-5로 변경 및 장바구니 버튼 추가 -->
        <footer class="bottom-nav fixed bottom-0 left-1/2 -translate-x-1/2 max-w-lg w-full grid grid-cols-5 text-center bg-white border-t border-gray-200 z-20">
            <button onclick="showCartModal()" class="nav-btn p-4 flex flex-col items-center justify-center text-gray-500">
                <i class="ph ph-shopping-cart text-2xl"></i>
                <span class="text-xs mt-1">장바구니</span>
            </button>
            <button data-screen="recentStoresScreen" class="nav-btn p-4 flex flex-col items-center justify-center text-gray-500">
                <i class="ph ph-clock-counter-clockwise text-2xl"></i>
                <span class="text-xs mt-1">최근 본 가게</span>
            </button>
            <button data-screen="homeScreen" class="nav-btn p-4 flex flex-col items-center justify-center text-gray-500 active">
                <i class="ph ph-house text-2xl"></i>
                <span class="text-xs mt-1">홈</span>
            </button>
            <button data-screen="favoritesScreen" class="nav-btn p-4 flex flex-col items-center justify-center text-gray-500">
                <i class="ph ph-heart text-2xl"></i>
                <span class="text-xs mt-1">관심 가게</span>
            </button>
            <button data-screen="myOrdersScreen" class="nav-btn p-4 flex flex-col items-center justify-center text-gray-500">
                <i class="ph ph-receipt text-2xl"></i>
                <span class="text-xs mt-1">내 주문</span>
            </button>
        </footer>

    </div>

    <script>
        // IIFE (Immediately Invoked Function Expression) to avoid polluting the global scope
        (() => {
            // ==================== RAW DATA ====================
            const marketData = [
                {"고유ID":1,"가게이름":"수희과일","가게분류":"청과물","main_product":"딸기, 레몬, 바나나, 배, 복숭아, 사과, 샤인머스켓, 수박, 오렌지, 자두, 참외, 키위, 토마토, 포도, 멜론, 체리, 망고, 씨 없는 수박, 곶감","위치":"가-42/경동시장로","특징":"신선한 제철 과일과 다양한 수입 과일을 취급합니다. 여름에는 특히 복숭아, 수박 등 당도 높은 과일이 인기가 많습니다.","좌표":"873,244","url":"monumental-mochi-19e075.netlify.app"},
                {"고유ID":2,"가게이름":"안동상회","가게분류":"청과물","main_product":"귤, 딸기, 사과, 수박, 멜론, 홍시, 방울토마토","위치":"가-43/경동시장로","특징":"계절별로 인기 있는 과일 위주로 판매하며, 여름에는 멜론과 수박이 특히 인기가 많습니다.","좌표":"873,266","url":"melodious-cocada-d9c1a0.netlify.app"},
                {"고유ID":3,"가게이름":"소문난반찬","가게분류":"가공식품","main_product":"게장, 새우장, 전복장, 명란젓, 갈치속젓","위치":"가-44/경동시장로","특징":"밥도둑으로 유명한 게장을 전문적으로 판매하며, 다양한 해산물 장류와 젓갈류도 맛볼 수 있습니다.","좌표":"873,290","url":"astonishing-mooncake-65b1b6.netlify.app"},
                {"고유ID":4,"가게이름":"한양상회","가게분류":"농산물","main_product":"대파, 시금치, 양파, 쌈 채소(상추, 깻잎), 버섯(느타리, 새송이)","위치":"가-45/경동시장로","특징":"요리에 필수적인 기본 채소와 함께 다양한 쌈 채소를 판매합니다.","좌표":"873,310","url":"radiant-pony-a7da7a.netlify.app"},
                {"고유ID":5,"가게이름":"대동상회","가게분류":"청과물","main_product":"복숭아, 블루베리, 사과, 자두, 멜론, 캠벨 포도, 거봉","위치":"가-46/경동시장로","특징":"여름 제철 과일인 복숭아와 자두를 주로 판매하며, 다양한 포도 품종도 취급합니다.","좌표":"873,373","url":"neon-meerkat-4067b7.netlify.app"},
                {"고유ID":6,"가게이름":"태영상회","가게분류":"청과물","main_product":"수박, 자두, 참외, 복숭아, 천도복숭아, 포도","위치":"가-47/경동시장로","특징":"여름철 당도 높은 수박과 새콤달콤한 자두, 복숭아 등 과일이 주력 상품입니다.","좌표":"873,400","url":"magenta-griffin-12af46.netlify.app"},
                {"고유ID":7,"가게이름":"일호청과","가게분류":"청과물","main_product":"귤, 수박, 참외, 토마토, 포도, 멜론, 방울토마토, 망고","위치":"가-48/경동시장로","특징":"신선한 제철 과일과 함께 간식용 방울토마토나 수입 망고도 판매합니다.","좌표":"873,440","url":"sage-basbousa-844b2a.netlify.app"},
                {"고유ID":8,"가게이름":"청도상회","가게분류":"농산물","main_product":"고추, 깻잎, 마늘, 양파, 오이, 호박잎, 부추, 애호박, 쪽파","위치":"가-49/경동시장로","특징":"요리에 필요한 신선한 채소와 함께 찌개용 애호박이나 김치 재료로 쓰이는 쪽파를 판매합니다.","좌표":"873,464","url":"boisterous-macaron-6129ed.netlify.app"},
                {"고유ID":9,"가게이름":"전국상회","가게분류":"청과물","main_product":"복숭아, 블루베리, 오렌지, 자두, 체리, 망고스틴, 파인애플","위치":"가-50/경동시장로","특징":"여름 과일과 함께 이국적인 맛의 수입 열대 과일을 다양하게 판매합니다.","좌표":"870,508","url":"magenta-meringue-f01c8e.netlify.app"},
                {"고유ID":10,"가게이름":"말구상회","가게분류":"농산물","main_product":"고구마, 고추, 상추, 호박, 감자, 대파, 버섯, 오이","위치":"가-51/경동시장로","특징":"찌개나 구이, 튀김에 쓰이는 감자와 고구마 등 필수 농산물을 취급합니다.","좌표":"873,548","url":"astonishing-meerkat-1deecd.netlify.app"},
                {"고유ID":11,"가게이름":"일품상회","가게분류":"농산물","main_product":"감자, 고구마, 고추, 상추, 양파, 오이, 당근, 배추, 마늘, 생강","위치":"가-52/경동시장로","특징":"다양한 요리에 쓰이는 기본 채소와 함께 마늘, 생강 등 향신 채소도 판매합니다.","좌표":"875,600","url":"melodious-tartufo-10b45c.netlify.app"},
                {"고유ID":12,"가게이름":"삼천리자전거","가게분류":"서비스","main_product":"자전거, 어린이 자전거, 성인용 자전거, 헬멧, 자전거 용품","위치":"왕산로 ","특징":"자전거 판매뿐만 아니라 수리 및 정비 서비스도 제공합니다.","좌표":"856,595","url":"polite-tartufo-90470b.netlify.app"},
                {"고유ID":13,"가게이름":"한국토종물산","가게분류":"한약재","main_product":"귀리, 녹용, 당귀, 칡즙, 산수유, 헛개나무, 작두콩","위치":"왕산로","특징":"토종 약재와 함께 건강을 챙길 수 있는 다양한 약초와 건강식품을 판매합니다.","좌표":"780,592","url":"astounding-frangipane-71af24.netlify.app"},
                {"고유ID":14,"가게이름":"빅토리가방","가게분류":"생활용품(잡화)","main_product":"병, 주걱, 청소도구, 여행용 가방, 학생용 백팩, 지갑, 핸드백, 캐리어","위치":"왕산로","특징":"다양한 종류의 가방을 판매하는 곳입니다.","좌표":"736,595","url":"dainty-gecko-a2606b.netlify.app"},
                {"고유ID":15,"가게이름":"포천농장","가게분류":"정육점","main_product":"돼지갈비, 떡갈비, 목살, 삼겹살, 소고기 국거리, 소고기 등심, 오리고기, 항정살, 가브리살, 소불고기, 돼지불고기, 닭갈비","위치":"왕산로","특징":"신선한 축산물을 부위별로 판매하며, 구이용 삼겹살과 목살, 국거리용 소고기 등 용도에 맞게 구매할 수 있습니다.","좌표":"690,595","url":"leafy-marzipan-39c756.netlify.app"},
                {"고유ID":16,"가게이름":"한초한의원","가게분류":"서비스","main_product":"침술, 부항, 한약 처방, 뜸, 체질 개선","위치":"왕산로","특징":"한의학 진료를 통해 건강을 관리하는 곳입니다.","좌표":"654,595","url":"subtle-marigold-4c24c3.netlify.app"},
                {"고유ID":17,"가게이름":"바다먹거리장터","가게분류":"수산물","main_product":"꽃게, 대게, 랍스터, 전복, 킹크랩, 회, 광어, 우럭, 연어, 문어, 낙지, 조개","위치":"왕산로","특징":"신선한 활어회와 함께 제철 해산물을 저렴하게 판매하며, 살아있는 킹크랩, 대게도 취급합니다.","좌표":"620,595","url":"gleaming-tartufo-7fa3ba.netlify.app"},
                {"고유ID":18,"가게이름":"경동DC아울렛","가게분류":"철물","main_product":"공구, 와이어, 철사, 파이프, 망치, 드라이버, 못, 볼트, 스패너, 톱","위치":"왕산로","특징":"각종 공구와 건축 자재를 판매하는 철물점입니다.","좌표":"580,595","url":"fluffy-sopapillas-ce0cf9.netlify.app"},
                {"고유ID":19,"가게이름":"충남민물/충남물산","가게분류":"한약재","main_product":"녹용, 당귀, 홍삼, 꿀, 인삼, 산수유, 칡, 약초","위치":"왕산로","특징":"몸에 좋은 약재를 취급하며, 특히 녹용과 홍삼이 인기가 많습니다.","좌표":"507,595","url":"chimerical-griffin-25f8e2.netlify.app"},
                {"고유ID":20,"가게이름":"서울마림죽","가게분류":"음식점(한식)","main_product":"메생이죽, 팥죽, 호박죽, 소고기야채죽, 해물죽, 전복죽, 잣죽","위치":"왕산로","특징":"건강에 좋은 다양한 죽을 판매하며, 특히 전복죽이 인기가 많습니다.","좌표":"430,595","url":"candid-seahorse-8291b8.netlify.app"},
                {"고유ID":21,"가게이름":"경동제일약초","가게분류":"한약재","main_product":"녹용, 당귀, 백숙, 쑥, 홍삼, 쌍화차, 십전대보탕, 작두콩차, 오미자","위치":"왕산로","특징":"다양한 약재와 백숙 재료를 판매하며, 건강 차를 끓여 먹을 수 있는 재료도 취급합니다.","좌표":"380,595","url":"lucky-nougat-cf6245.netlify.app"},
                {"고유ID":22,"가게이름":"천연발효호밀빵","가게분류":"음식점(제과제빵)","main_product":"모닝빵, 식빵, 호밀빵, 통밀빵, 치아바타, 크루아상, 베이글","위치":"왕산로","특징":"건강한 재료로 만든 발효빵을 판매합니다.","좌표":"345,595","url":"warm-sfogliatella-df7087.netlify.app"},
                {"고유ID":23,"가게이름":"주차상회","가게분류":"농산물","main_product":"달래, 배추, 부추, 미나리, 시금치, 쪽파","위치":"왕산로29번길","특징":"신선한 채소와 향긋한 봄나물을 판매합니다.","좌표":"345,595","url":"euphonious-otter-33ed2f.netlify.app"},
                {"고유ID":24,"가게이름":"동강제분소","가게분류":"서비스","main_product":"밀가루, 쌀가루, 전분가루, 보리가루, 콩가루, 찹쌀가루, 율무가루","위치":"왕산로29번길","특징":"다양한 곡물을 갈아 가루로 만들어주는 방앗간입니다.","좌표":"269,595","url":"chimerical-stroopwafel-c54534.netlify.app"},
                {"고유ID":25,"가게이름":"신토불이 축산물직판장","가게분류":"정육점","main_product":"닭고기, 목살, 삼겹살, 소갈비, 소고기 국거리, 소고기 등심, 오리고기, 한우 특수부위(살치살, 갈비살), 돼지 특수부위(항정살, 가브리살)","위치":"왕산로29번길","특징":"신선한 한우와 돼지고기를 저렴한 가격에 판매하며, 다양한 부위와 특수 부위를 취급합니다.","좌표":"269,595","url":"kaleidoscopic-blini-990589.netlify.app"},
                {"고유ID":26,"가게이름":"전진찰옥수수","가게분류":"농산물","main_product":"번데기, 옥수수, 찐 옥수수, 옥수수 강정, 옥수수 가루","위치":"왕산로29번길","특징":"옥수수를 전문으로 판매하며, 옥수수를 이용한 간식과 가공품도 취급합니다.","좌표":"211,595","url":"flourishing-mandazi-bfdc91.netlify.app"},
                {"고유ID":27,"가게이름":"보령상회","가게분류":"농산물","main_product":"견과류, 대추, 밤, 호두, 땅콩, 아몬드, 건포도","위치":"왕산로29번길","특징":"영양 간식인 견과류와 대추, 밤을 판매합니다.","좌표":"172,595","url":"tangerine-narwhal-2b9191.netlify.app"},
                {"고유ID":28,"가게이름":"광송상회","가게분류":"건강식품","main_product":"녹용, 인삼, 홍삼, 벌꿀, 영지버섯, 상황버섯, 도라지청","위치":"왕산로29번길","특징":"건강식품 전문점으로, 녹용, 인삼, 홍삼 등 보양식 재료를 판매합니다.","좌표":"99,595","url":"inquisitive-hotteok-c82439.netlify.app"},
                {"고유ID":29,"가게이름":"거북이젓갈","가게분류":"반찬/김치","main_product":"낙지젓, 새우젓, 오징어젓, 창난젓, 명란젓, 갈치속젓, 어리굴젓, 꼴뚜기젓","위치":"고산자로36번길/좌","특징":"밥반찬으로 좋은 다양한 젓갈을 전문으로 판매하며, 젓갈 종류가 다양합니다.","좌표":"232,470","url":"inspiring-queijadas-84fd9a.netlify.app"},
                {"고유ID":30,"가게이름":"창신푸드","가게분류":"반찬/김치","main_product":"낙지젓, 오징어젓, 창난젓, 명란젓, 꼴뚜기젓, 낙지젓","위치":"고산자로36번길/좌","특징":"신선한 해산물로 만든 젓갈을 판매합니다.","좌표":"301,470","url":"majestic-truffle-519ce2.netlify.app"},
                {"고유ID":31,"가게이름":"진광젓갈","가게분류":"반찬/김치","main_product":"낙지젓, 새우젓, 오징어젓, 창난젓, 명란젓, 꼴뚜기젓, 젓갈류","위치":"고산자로36번길/좌","특징":"여러 종류의 젓갈을 취급합니다.","좌표":"301,470","url":"sage-concha-523f8f.netlify.app"},
                {"고유ID":32,"가게이름":"담가불라","가게분류":"반찬/김치","main_product":"낙지젓, 새우젓, 오징어젓, 창난젓, 명란젓, 어리굴젓, 갈치속젓","위치":"고산자로36번길/좌","특징":"직접 담근 젓갈을 판매하며, 특히 젓갈 종류가 매우 다양합니다.","좌표":"385,470","url":"elaborate-valkyrie-bddaf5.netlify.app"},
                {"고유ID":33,"가게이름":"덕성상회","가게분류":"반찬/김치","main_product":"깍두기, 깻잎장아찌, 동치미, 멸치볶음, 진미채무침, 파김치, 무말랭이, 잡채, 콩자반, 우엉조림, 코다리찜","위치":"고산자로36번길/좌","특징":"다양한 종류의 반찬을 판매합니다. 매일 신선하게 만들어낸 맛있는 반찬을 만날 수 있습니다.","좌표":"444,470","url":"startling-entremet-00e14e.netlify.app"},
                {"고유ID":34,"가게이름":"예나떡방","가게분류":"음식점(한식)","main_product":"가래떡, 꿀떡, 시루떡, 백설기, 팥시루떡, 송편, 인절미, 쑥떡","위치":"고산자로36번길/좌","특징":"다양한 떡을 만들어 판매하는 떡집입니다.","좌표":"487,470","url":"magical-toffee-8e78aa.netlify.app"},
                {"고유ID":35,"가게이름":"형신유통","가게분류":"농산물","main_product":"도라지, 백미, 콩, 팥, 현미, 흑미, 찹쌀, 보리, 율무, 렌틸콩, 서리태","위치":"고산자로36번길/좌","특징":"쌀, 콩, 팥 등 다양한 곡물을 주로 판매하며, 도라지 같은 농산물도 취급합니다.","좌표":"487,470","url":"deluxe-capybara-e07689.netlify.app"},
                {"고유ID":36,"가게이름":"우리상회","가게분류":"반찬/김치","main_product":"게장, 배추김치, 파김치, 총각김치, 갓김치, 열무김치, 오이소박이","위치":"고산자로36번길/좌","특징":"직접 담근 김치와 게장을 판매하는 곳입니다.","좌표":"592,470","url":"adorable-capybara-6e92ff.netlify.app"},
                {"고유ID":37,"가게이름":"현리상회","가게분류":"농산물","main_product":"고구마, 대파, 마늘, 양파, 감자, 상추, 깻잎, 오이, 호박","위치":"고산자로36번길/좌","특징":"신선한 채소를 저렴한 가격에 판매합니다.","좌표":"592,470","url":"vocal-daifuku-263577.netlify.app"},
                {"고유ID":38,"가게이름":"오메다나와부럿소","가게분류":"수산물","main_product":"갈치, 고등어, 낙지, 노가리, 다시마, 꽁치, 조기, 주꾸미, 오징어, 미역, 황태","위치":"고산자로36번길/좌","특징":"신선한 생선과 건어물, 해산물을 다양하게 판매합니다.","좌표":"668,470","url":"effortless-fairy-9b3777.netlify.app"},
                {"고유ID":39,"가게이름":"서부상회","가게분류":"수산물","main_product":"갈치, 고등어, 오징어, 조기, 주꾸미, 꽁치, 멸치, 다시마, 미역","위치":"고산자로36번길/좌","특징":"싱싱한 생선과 함께 다시마, 미역 등 건해산물도 취급합니다.","좌표":"668,470","url":"timely-monstera-0b7b14.netlify.app"},
                {"고유ID":40,"가게이름":"정가네","가게분류":"수산물","main_product":"조기, 황태, 굴비, 명태, 코다리, 대구, 오징어","위치":"고산자로36번길/좌","특징":"생선과 건어물을 전문적으로 판매합니다. 특히 조기와 황태가 인기가 많습니다.","좌표":"744,470","url":"resonant-hotteok-360c14.netlify.app"},
                {"고유ID":41,"가게이름":"신재상회","가게분류":"수산물","main_product":"갈치, 고등어, 꽁치, 낙지, 오징어, 조기, 주꾸미, 멸치, 황태포","위치":"고산자로36번길/좌","특징":"신선한 생선을 전문으로 판매합니다.","좌표":"744,470","url":"friendly-crepe-c4777c.netlify.app"},
                {"고유ID":42,"가게이름":"무궁화꽃이피었습니다","가게분류":"반찬/김치","main_product":"낙지젓, 새우젓, 오징어젓, 창난젓, 명란젓, 어리굴젓, 꼴뚜기젓","위치":"고산자로36번길/좌","특징":"밥도둑 젓갈을 다양하게 판매합니다.","좌표":"828,470","url":"ephemeral-monstera-f6d64a.netlify.app"},
                {"고유ID":43,"가게이름":"번영종합건어물","가게분류":"가공식품","main_product":"건어물, 쥐포, 오징어, 멸치, 다시마, 황태포, 먹태, 김","위치":"고산자로36번길/좌","특징":"각종 건어물을 판매하며, 간식용 쥐포와 요리용 건어물을 모두 구매할 수 있습니다.","좌표":"828,470","url":"genuine-torte-2ed795.netlify.app"},
                {"고유ID":44,"가게이름":"동도상회","가게분류":"청과물","main_product":"블루베리, 아보카도, 망고, 체리, 키위, 파인애플, 레몬","위치":"고산자로36번길/좌","특징":"수입 과일을 주로 취급하는 곳으로, 블루베리와 아보카도가 주력 상품입니다.","좌표":"870,470","url":"calm-sable-70bb9a.netlify.app"},
                {"고유ID":45,"가게이름":"한국상회","가게분류":"가공식품","main_product":"건어물, 옥수수, 쥐포, 오징어채, 멸치, 황태포, 볶은 옥수수","위치":"나-24/고산자로36번길","특징":"건어물과 옥수수를 판매합니다.","좌표":"870,238","url":"sensational-fox-7679dd.netlify.app"},
                {"고유ID":46,"가게이름":"한주상회","가게분류":"농산물","main_product":"대추, 밤, 은행, 잣, 호두, 땅콩, 건포도","위치":"고산자로36번길/우","특징":"건강 간식인 대추, 밤, 은행을 판매합니다.","좌표":"444,507","url":"snazzy-moonbeam-071f07.netlify.app"},
                {"고유ID":47,"가게이름":"정풍농산","가게분류":"농산물","main_product":"대추, 마늘, 무, 밤, 은행, 호박, 생강, 고추, 상추, 깻잎","위치":"고산자로36번길/우","특징":"다양한 종류의 농산물을 취급합니다. 요리에 필요한 식재료를 한 번에 구매할 수 있습니다.","좌표":"444,507","url":"eloquent-tanuki-76d690.netlify.app"},
                {"고유ID":48,"가게이름":"경기유통","가게분류":"가공식품","main_product":"더덕, 도라지, 인삼, 칡즙, 산수유, 꿀, 약초","위치":"고산자로36번길/우","특징":"몸에 좋은 더덕, 도라지, 인삼 등 뿌리 채소를 판매합니다.","좌표":"527,501","url":"voluble-sunshine-ab7c13.netlify.app"},
                {"고유ID":49,"가게이름":"금산인삼","가게분류":"가공식품","main_product":"더덕, 도라지, 인삼, 수삼, 산양삼, 홍삼액, 인삼주","위치":"고산자로36번길/우","특징":"금산 지역의 품질 좋은 인삼과 더덕, 도라지를 전문으로 판매합니다.","좌표":"527,501","url":"voluble-nougat-79a2e6.netlify.app"},
                {"고유ID":50,"가게이름":"공남상회","가게분류":"농산물","main_product":"백미, 보리, 콩, 팥, 현미, 흑미, 찹쌀, 율무, 잡곡, 서리태, 녹두","위치":"고산자로36번길/우","특징":"다양한 종류의 곡물을 판매합니다.","좌표":"592,501","url":"aquamarine-cat-604858.netlify.app"},
                {"고유ID":51,"가게이름":"정일상회","가게분류":"농산물","main_product":"더덕, 마늘, 무, 버섯, 콩, 팥, 고구마, 감자, 양파, 생강, 도라지","위치":"고산자로36번길/우","특징":"식재료부터 잡곡까지 다양한 농산물을 판매합니다.","좌표":"592,501","url":"astounding-eclair-984a40.netlify.app"},
                {"고유ID":52,"가게이름":"우리열매","가게분류":"청과물","main_product":"배, 사과, 토마토, 수박, 포도, 멜론, 체리, 망고","위치":"고산자로36번길/우","특징":"신선한 과일들을 판매합니다.","좌표":"668,501","url":"meek-sopapillas-16598f.netlify.app"},
                {"고유ID":53,"가게이름":"명성상회","가게분류":"농산물","main_product":"감자, 고구마, 당근, 양파, 호박, 오이","위치":"고산자로36번길/우","특징":"식탁에 자주 오르는 감자와 고구마를 판매합니다.","좌표":"744,501","url":"cosmic-sable-dfe67a.netlify.app"},
                {"고유ID":54,"가게이름":"광주상회","가게분류":"농산물","main_product":"감자, 고구마, 고추, 양파, 대파, 시금치, 깻잎","위치":"고산자로36번길/우","특징":"감자, 고구마, 고추 등 필수 식재료를 판매합니다.","좌표":"828,501","url":"fastidious-banoffee-c70d7b.netlify.app"},
                {"고유ID":55,"가게이름":"경동웰빙","가게분류":"농산물","main_product":"김, 대추, 미역, 다시마, 멸치, 황태, 꿀","위치":"왕산로29길","특징":"건강식품으로 좋은 김과 대추를 판매합니다.","좌표":"130,540","url":"curious-tanuki-7daecd.netlify.app"},
                {"고유ID":56,"가게이름":"성지상회","가게분류":"수산물","main_product":"갈치, 고등어, 꽁치, 다시마, 멸치, 오징어, 조기, 황태포, 미역, 명태포","위치":"왕산로29길","특징":"신선한 생선과 건어물을 취급합니다.","좌표":"130,520","url":"nimble-kulfi-e66a94.netlify.app"},
                {"고유ID":57,"가게이름":"영환네약초","가게분류":"한약재","main_product":"녹용, 당귀, 홍삼, 인삼, 쑥, 대추, 오미자, 칡, 영지버섯","위치":"왕산로29길","특징":"몸에 좋은 약재를 판매하는 곳입니다.","좌표":"130,485","url":"deft-cactus-f3bf68.netlify.app"},
                {"고유ID":58,"가게이름":"충북상회","가게분류":"가공식품","main_product":"건어물, 쥐포, 오징어, 멸치, 황태, 먹태, 다시마, 김","위치":"왕산로29길","특징":"다양한 건어물을 판매합니다.","좌표":"130,447","url":"legendary-torte-779946.netlify.app"},
                {"고유ID":59,"가게이름":"약초사랑","가게분류":"농산물","main_product":"달래, 당귀, 백숙, 쑥, 인삼, 오미자, 작두콩, 은행, 홍삼","위치":"왕산로29길","특징":"백숙 재료와 함께 다양한 약초를 판매합니다.","좌표":"194,392","url":"legendary-torte-779946.netlify.app"},
                {"고유ID":60,"가게이름":"보현농장","가게분류":"농산물","main_product":"옥수수, 찐 옥수수, 옥수수 가루, 옥수수 강정","위치":"왕산로29길","특징":"옥수수를 전문으로 판매합니다.","좌표":"194,349","url":"sprightly-snickerdoodle-f4feb3.netlify.app"},
                {"고유ID":61,"가게이름":"문경상회","가게분류":"농산물","main_product":"부추, 시금치, 옥수수, 감자, 고구마, 양파, 대파","위치":"왕산로29길","특징":"신선한 채소와 옥수수를 판매합니다.","좌표":"194,304","url":"heroic-douhua-ed4c0c.netlify.app"},
                {"고유ID":62,"가게이름":"고바우기름집","가게분류":"서비스","main_product":"들기름, 참기름, 생들기름, 생참기름, 검은깨 기름, 참깨","위치":"왕산로29길","특징":"신선한 기름을 직접 짜서 판매하는 곳입니다.","좌표":"127,261","url":"jovial-pixie-2981a5.netlify.app"},
                {"고유ID":63,"가게이름":"원님네제분소","가게분류":"서비스","main_product":"밀가루, 쌀가루, 전분가루, 찹쌀가루, 보리가루, 콩가루, 율무가루","위치":"왕산로29길","특징":"곡물을 빻아 가루로 만들어주는 방앗간입니다.","좌표":"257,261","url":"unrivaled-sherbet-589d9c.netlify.app"},
                {"고유ID":64,"가게이름":"성현물산","가게분류":"농산물","main_product":"당귀, 더덕, 도라지, 쑥, 인삼, 녹용, 홍삼, 칡, 오미자","위치":"왕산로29길","특징":"몸에 좋은 약초와 뿌리 채소를 판매합니다.","좌표":"257,304","url":"coruscating-gumption-1d52e9.netlify.app"},
                {"고유ID":65,"가게이름":"태현약초","가게분류":"농산물","main_product":"녹용, 당귀, 대추, 더덕, 도라지, 쑥, 은행, 인삼, 홍삼, 상황버섯, 영지버섯, 감초, 생강, 칡, 오미자","위치":"왕산로29길/다-31","특징":"약초 전문점으로, 다양한 한약재를 취급합니다.","좌표":"257,349","url":"fancy-halva-cf7d3c.netlify.app"},
                {"고유ID":66,"가게이름":"연서네떡갈비","가게분류":"음식점(한식)","main_product":"떡갈비, 매운 떡갈비, 치즈 떡갈비, 수제 돈가스, 함박 스테이크","위치":"왕산로29길/다-32","특징":"직접 만든 맛있는 떡갈비를 판매합니다.","좌표":"257,392","url":"deluxe-belekoy-092e9c.netlify.app"},
                {"고유ID":67,"가게이름":"풍작상회","가게분류":"가공식품","main_product":"건어물, 노가리, 다시마, 오징어채, 쥐포, 멸치, 황태포, 먹태, 김, 미역","위치":"고산자로 38번길/다-1","특징":"다양한 종류의 건어물을 판매합니다.","좌표":"352,328","url":"preeminent-salamander-d84af8.netlify.app"},
                {"고유ID":68,"가게이름":"크로바신발","가게분류":"생활용품(잡화)","main_product":"신발, 운동화, 구두, 슬리퍼, 샌들, 등산화, 장화","위치":"고산자로 38번길/다-2","특징":"다양한 신발을 판매하는 신발 가게입니다.","좌표":"450,359","url":"resplendent-lokum-4e390d.netlify.app"},
                {"고유ID":69,"가게이름":"영심이네","가게분류":"음식점(간식/디저트)","main_product":"닭강정, 닭꼬치, 통닭, 닭발, 순살치킨","위치":"고산자로 38번길/다-3","특징":"바삭하고 달콤한 닭강정을 판매합니다.","좌표":"509,372","url":"loquacious-otter-bc9a1d.netlify.app"},
                {"고유ID":70,"가게이름":"소반술빵","가게분류":"음식점(제과제빵)","main_product":"술빵, 찐빵, 꽈배기, 찹쌀도넛, 옛날빵","위치":"고산자로 38번길/다-4","특징":"푹신하고 맛있는 술빵을 판매합니다.","좌표":"554,372","url":"harmonious-croissant-c89a0f.netlify.app"},
                {"고유ID":71,"가게이름":"대광상회","가게분류":"반찬/김치","main_product":"낙지젓, 새우젓, 오징어젓, 창난젓, 명란젓, 어리굴젓, 꼴뚜기젓, 갈치속젓","위치":"고산자로 38번길/다-5","특징":"다양한 종류의 젓갈을 판매합니다.","좌표":"587,359","url":"gorgeous-khapse-cbaaa8.netlify.app"},
                {"고유ID":72,"가게이름":"양평순대국","가게분류":"음식점(한식)","main_product":"국밥, 순대국, 뼈해장국, 감자탕, 순대","위치":"고산자로 38번길/다-6","특징":"순대국 전문 식당입니다.","좌표":"640,359","url":"eclectic-muffin-804442.netlify.app"},
                {"고유ID":73,"가게이름":"충북보리밥집","가게분류":"음식점(한식)","main_product":"보리밥, 비빔밥, 콩나물밥, 청국장, 된장찌개","위치":"고산자로 38번길/다-7","특징":"건강하고 맛있는 보리밥을 맛볼 수 있는 식당입니다.","좌표":"712,359","url":"cerulean-eclair-17228d.netlify.app"},
                {"고유ID":74,"가게이름":"한성함흥냉면","가게분류":"음식점(한식)","main_product":"물냉면, 비빔냉면, 회냉면, 수육, 만두","위치":"고산자로 38번길/다-35","특징":"시원한 물냉면과 매콤한 비빔냉면을 맛볼 수 있는 곳입니다.","좌표":"785,359","url":"melodious-souffle-1be485.netlify.app"},
                {"고유ID":75,"가게이름":"한우곰탕","가게분류":"음식점(한식)","main_product":"곰탕, 설렁탕, 소머리국밥, 육개장","위치":"고산자로 38번길/다-36","특징":"진하고 깊은 맛의 한우 곰탕을 판매합니다.","좌표":"865,359","url":"melodic-bonbon-3c7571.netlify.app"},
                {"고유ID":76,"가게이름":"한성기름/고추","가게분류":"농산물","main_product":"고추, 들기름, 참기름, 건고추, 태양초, 볶은 깨, 콩기름","위치":"고산자로 38번길/다-37","특징":"신선한 고추와 직접 짠 들기름, 참기름을 판매합니다.","좌표":"865,323","url":"rococo-sunshine-7c9483.netlify.app"},
                {"고유ID":77,"가게이름":"심가네떡집","가게분류":"음식점(한식)","main_product":"가래떡, 꿀떡, 시루떡, 백설기, 송편, 인절미, 쑥떡, 절편","위치":"고산자로 38번길/다-38","특징":"다양한 떡을 판매하는 떡집입니다.","좌표":"829,323","url":"shimmering-cannoli-833d20.netlify.app"},
                {"고유ID":78,"가게이름":"대광그릇","가게분류":"생활용품(잡화)","main_product":"그릇, 접시, 컵, 수저, 냄비, 프라이팬, 주방용품","위치":"고산자로 38번길/다-39","특징":"여러 종류의 그릇을 판매하는 상점입니다.","좌표":"785,323","url":"voluble-tulumba-d0e1c4.netlify.app"},
                {"고유ID":79,"가게이름":"삼연유통","가게분류":"생활용품(잡화)","main_product":"와이어, 철사, 파이프, 망치, 드라이버, 못, 볼트, 너트, 공구","위치":"고산자로 38번길/다-40","특징":"다양한 철물 용품을 판매합니다.","좌표":"748,323","url":"aesthetic-babka-5cd9c8.netlify.app"},
                {"고유ID":80,"가게이름":"부산제과","가게분류":"음식점(제과제빵)","main_product":"모닝빵, 식빵, 단팥빵, 소보루빵, 크림빵, 맘모스빵, 카스텔라","위치":"고산자로 38번길/다-41","특징":"갓 구운 신선한 빵을 판매합니다.","좌표":"712,323","url":"wonderful-boba-067828.netlify.app"},
                {"고유ID":81,"가게이름":"대호튀김만두","가게분류":"음식점(한식)","main_product":"만두, 김치만두, 고기만두, 찐만두, 군만두","위치":"고산자로 38번길/다-42","특징":"바삭한 튀김만두를 판매합니다.","좌표":"640,323","url":"dreamy-lokum-772206.netlify.app"},
                {"고유ID":82,"가게이름":"수억상회","가게분류":"반찬/김치","main_product":"겉절이, 깍두기, 깻잎장아찌, 나물무침, 동치미, 멸치볶음, 배추김치, 진미채무침, 잡채, 총각김치, 파김치, 콩자반, 무말랭이, 시금치나물, 고사리나물, 도라지나물","위치":"고산자로 38번길/다-43","특징":"다양한 종류의 반찬을 판매하며, 특히 나물류가 많아 비빔밥 재료로 인기가 많습니다.","좌표":"587,323","url":"elegant-rolypoly-64f9a5.netlify.app"},
                {"고유ID":83,"가게이름":"태경상회","가게분류":"농산물","main_product":"대추, 밤, 은행, 잣, 호두, 땅콩, 아몬드, 건포도","위치":"고산자로 38번길/다-44","특징":"건강 간식인 대추, 밤, 은행을 판매합니다.","좌표":"494,323","url":"gregarious-biscotti-2fc0b7.netlify.app"},
                {"고유ID":84,"가게이름":"영동기물","가게분류":"철물","main_product":"도토리묵, 두부, 메밀묵, 송편, 시루떡, 인절미, 찹쌀떡, 절편, 백설기, 꿀떡","위치":"고산자로 38번길/다-45","특징":"철물과 함께 묵, 떡 등 다양한 식품도 취급합니다.","좌표":"475,262","url":"precious-buttercream-4ff83d.netlify.app"},
                {"고유ID":85,"가게이름":"대왕유통","가게분류":"가공식품","main_product":"견과류, 볶은 아몬드, 호두, 캐슈넛, 땅콩, 잣, 마카다미아","위치":"고산자로 38번길/다-46","특징":"다양한 견과류를 판매합니다.","좌표":"570,262","url":"gleaming-fenglisu-334d7a.netlify.app"},
                {"고유ID":86,"가게이름":"연자네야채","가게분류":"농산물","main_product":"고추, 깻잎, 마늘, 상추, 오이, 호박, 감자, 양파, 대파, 시금치, 부추, 당근","위치":"고산자로 38번길/다-47","특징":"신선한 채소를 저렴하게 판매합니다.","좌표":"705,238","url":"serene-kleicha-4a0487.netlify.app"},
                {"고유ID":87,"가게이름":"영진상회","가게분류":"가공식품","main_product":"견과류, 볶은 땅콩, 호두, 아몬드, 잣, 마카다미아","위치":"고산자로 38번길/다-48","특징":"다양한 견과류를 판매합니다.","좌표":"783,238","url":"elaborate-cucurucho-b05ebb.netlify.app"},
                {"고유ID":88,"가게이름":"지호네","가게분류":"농산물","main_product":"마늘, 생강, 참기름, 들기름, 고춧가루, 볶은 깨, 마늘장아찌","위치":"서울 동대문구 고산자로38길/다-21","특징":"마늘, 생강,D125:D131","좌표":"104,50","url":"reliable-kitten-457efe.netlify.app"},
                {"고유ID":89,"가게이름":"삼거리야채","가게분류":"농산물","main_product":"대파, 무, 쪽파, 배추, 양파, 시금치, 깻잎, 상추","위치":"서울 동대문구 고산자로38길/다-20","특징":"다양한 채소들을 판매합니다.","좌표":"150,50","url":"dancing-beijinho-d6f976.netlify.app"},
                {"고유ID":90,"가게이름":"태우농산","가게분류":"농산물","main_product":"고추, 참기름, 들기름, 볶은 깨, 고춧가루","위치":"서울 동대문구 고산자로38길/다-19","특징":"신선한 고추와 참기름을 판매합니다.","좌표":"90,107","url":"scintillating-moonbeam-61d4b4.netlify.app"},
                {"고유ID":91,"가게이름":"오복참기름","가게분류":"농산물","main_product":"고추, 참기름, 들기름, 볶은 깨, 콩기름","위치":"서울 동대문구 고산자로38길/다-18","특징":"참기름을 전문으로 판매합니다.","좌표":"150,107","url":"fancy-cendol-3d1adc.netlify.app"},
                {"고유ID":92,"가게이름":"경동함흥냉면","가게분류":"음식점(한식)","main_product":"물냉면, 비빔냉면, 회냉면, 갈비탕, 수육, 만두","위치":"서울 동대문구 고산자로38길/다-17","특징":"시원한 냉면을 맛볼 수 있는 곳입니다.","좌표":"90,160","url":"silly-conkies-ee7b31.netlify.app"},
                {"고유ID":93,"가게이름":"동건건어물","가게분류":"가공식품","main_product":"건어물, 노가리, 오징어채, 쥐포, 멸치, 황태포, 먹태, 김, 다시마","위치":"서울 동대문구 고산자로38길/다-16","특징":"다양한 건어물을 판매합니다.","좌표":"150,160","url":"incredible-toffee-b02bdd.netlify.app"},
                {"고유ID":94,"가게이름":"약식동원점","가게분류":"음식점(카페/음료)","main_product":"전통차, 쌍화차, 생강차, 오미자차, 대추차, 유자차","위치":"서울 동대문구 고산자로38길/다-15","특징":"몸에 좋은 전통차를 판매합니다.","좌표":"90,200","url":"nimble-heliotrope-9bd12f.netlify.app"},
                {"고유ID":95,"가게이름":"일번지정육점","가게분류":"정육점","main_product":"돼지갈비, 목살, 삼겹살, 소갈비, 소고기 국거리, 소고기 등심, 한우 특수부위(채끝, 안심), 소꼬리, 돼지갈매기살","위치":"서울 동대문구 고산자로38길/다-14","특징":"다양한 부위의 고기를 판매하며, 고급 부위와 국거리용 고기를 모두 구매할 수 있습니다.","좌표":"150,200","url":"timely-froyo-ca5acb.netlify.app"},
                {"고유ID":96,"가게이름":"천일농산","가게분류":"농산물","main_product":"고추, 들기름, 참기름, 볶은 깨, 쌀, 잡곡, 고춧가루","위치":"서울 동대문구 고산자로38길/다-13","특징":"신선한 고추와 직접 짠 들기름, 참기름을 판매합니다.","좌표":"270,43","url":"coruscating-pastelito-269f17.netlify.app"},
                {"고유ID":97,"가게이름":"춘천막국수","가게분류":"음식점(한식)","main_product":"모밀냉면, 소바, 막국수, 비빔막국수, 감자전, 닭갈비","위치":"서울 동대문구 고산자로38길/다-12","특징":"시원한 막국수와 소바를 판매합니다.","좌표":"286,43","url":"peaceful-toffee-76aa7c.netlify.app"},
                {"고유ID":98,"가게이름":"그시절그맛","가게분류":"음식점(제과제빵)","main_product":"꽈배기, 도너츠, 찐빵, 찹쌀도넛, 고로케, 소시지빵, 맘모스빵","위치":"서울 동대문구 고산자로38길/다-11","특징":"추억의 간식인 꽈배기, 도너츠 등을 판매합니다.","좌표":"270,90","url":"stellar-valkyrie-cf0231.netlify.app"},
                {"고유ID":99,"가게이름":"경동상회","가게분류":"건강식품","main_product":"더덕, 도라지, 인삼, 꿀, 홍삼액, 영지버섯, 상황버섯","위치":"서울 동대문구 고산자로38길/다-10","특징":"몸에 좋은 더덕, 도라지, 인삼을 판매합니다.","좌표":"286,90","url":"heartfelt-mermaid-3bc1df.netlify.app"},
                {"고유ID":100,"가게이름":"성일식품","가게분류":"음식점(한식)","main_product":"면, 칼국수, 잔치국수, 비빔국수, 콩국수","위치":"서울 동대문구 고산자로38길/다-9","특징":"다양한 면 요리를 판매합니다.","좌표":"270,118","url":"glittery-tiramisu-b533b0.netlify.app"},
                {"고유ID":101,"가게이름":"심성땅콩","가게분류":"가공식품","main_product":"건어물, 노가리, 오징어채, 쥐포, 멸치, 황태포, 먹태, 김, 다시마","위치":"서울 동대문구 고산자로38길/다-8","특징":"건어물 전문점입니다.","좌표":"290,120","url":"peaceful-longma-246c2a.netlify.app"},
                {"고유ID":102,"가게이름":"무등상회","가게분류":"농산물","main_product":"고추, 대파, 양파, 호박, 감자, 상추, 깻잎, 오이, 무","위치":"서울 동대문구","특징":"신선한 채소를 판매합니다.","좌표":"432,158","url":"stunning-mooncake-ee7f33.netlify.app"},
                {"고유ID":103,"가게이름":"금란상회","가게분류":"농산물","main_product":"무, 배추, 쪽파, 시금치, 대파, 양배추","위치":"서울 동대문구","특징":"김장 재료인 무와 배추를 판매합니다.","좌표":"449,158","url":"tranquil-paletas-20100c.netlify.app"},
                {"고유ID":104,"가게이름":"횡성상회","가게분류":"농산물","main_product":"무, 배추, 양파, 쪽파, 감자, 고구마, 시금치, 대파","위치":"서울 동대문구","특징":"다양한 채소들을 판매합니다.","좌표":"432,202","url":"frolicking-halva-a1fdba.netlify.app"},
                {"고유ID":105,"가게이름":"돼지상회","가게분류":"농산물","main_product":"마늘, 배추, 양파, 고추, 생강, 시금치, 무","위치":"서울 동대문구","특징":"요리에 필수적인 식재료를 판매합니다.","좌표":"449,202","url":"neon-meerkat-b0addd.netlify.app"},
                {"고유ID":106,"가게이름":"풍성상회","가게분류":"농산물","main_product":"대파, 무, 배추, 양배추, 감자, 양파, 오이, 호박, 상추","위치":"서울 동대문구","특징":"다양한 채소를 판매합니다.","좌표":"515,46","url":"funny-sunflower-88b974.netlify.app"},
                {"고유ID":107,"가게이름":"파란수산","가게분류":"수산물","main_product":"오징어, 한치, 낙지, 주꾸미, 꽁치, 갈치, 고등어","위치":"서울 동대문구","특징":"신선한 오징어와 한치를 판매합니다.","좌표":"543,46","url":"fascinating-meerkat-9b41f8.netlify.app"},
                {"고유ID":108,"가게이름":"쭈니식자재","가게분류":"농산물","main_product":"고추, 대파, 마늘, 양파, 감자, 양배추, 무, 배추, 시금치","위치":"서울 동대문구","특징":"식당에 납품할 정도로 품질 좋은 채소를 판매합니다.","좌표":"558,112","url":"dainty-torte-ccafea.netlify.app"},
                {"고유ID":109,"가게이름":"수민건어물","가게분류":"수산물","main_product":"먹태, 오징어, 한치, 멸치, 황태포, 다시마, 김, 쥐포","위치":"서울 동대문구","특징":"다양한 건어물을 취급합니다.","좌표":"558,82","url":"stalwart-crostata-72d444.netlify.app"},
                {"고유ID":110,"가게이름":"대흥유통","가게분류":"가공식품","main_product":"계란, 쌀, 잡곡, 현미, 흑미, 찹쌀, 콩","위치":"서울 동대문구","특징":"신선한 계란과 쌀을 판매합니다.","좌표":"558,152","url":"silver-kangaroo-622764.netlify.app"},
                {"고유ID":111,"가게이름":"푸른야채","가게분류":"농산물","main_product":"고추, 대파, 마늘, 양파, 시금치, 상추, 깻잎, 오이, 호박","위치":"서울 동대문구","특징":"신선한 채소를 판매합니다.","좌표":"558,193","url":"heartfelt-blancmange-e6a963.netlify.app"},
                {"고유ID":112,"가게이름":"농민유통","가게분류":"농산물","main_product":"감자, 고구마, 당근, 양파, 대파, 무, 배추, 오이, 호박","위치":"서울 동대문구","특징":"다양한 농산물을 판매합니다.","좌표":"635,100","url":"lively-bavarois-ca7a38.netlify.app"},
                {"고유ID":113,"가게이름":"청원상회","가게분류":"농산물","main_product":"감자, 고추, 대파, 마늘, 사과, 수박, 양파, 무, 배추, 호박, 오이, 상추","위치":"서울 동대문구","특징":"다양한 농산물과 과일을 함께 판매합니다.","좌표":"680,155","url":"ubiquitous-pika-c403d1.netlify.app"},
                {"고유ID":114,"가게이름":"경덕청과","가게분류":"청과물","main_product":"수박, 참외, 토마토, 포도, 멜론, 자두, 복숭아, 사과, 배","위치":"서울 동대문구","특징":"여름 제철 과일을 주로 판매합니다.","좌표":"680,200","url":"scintillating-klepon-18ce24.netlify.app"},
                {"고유ID":115,"가게이름":"화장실2","가게분류":"편의시설","main_product":null,"위치":"서울 동대문구","특징":"공용시설","좌표":"660,30","url":"shimmering-macaron-b3333b.netlify.app"},
                {"고유ID":116,"가게이름":"경기한식집","가게분류":"음식점(한식)","main_product":"비빔밥, 된장찌개, 김치찌개, 제육볶음","위치":"서울 동대문구","특징":"전통적인 한식 메뉴를 맛볼 수 있는 식당입니다. 시장 구경 후 든든한 식사를 즐기기 좋습니다.","좌표":"270,170","url":"dulcet-piroshki-6fe51e.netlify.app"},
                {"고유ID":117,"가게이름":"멋진빵집","가게분류":"음식점(제과제빵)","main_product":"단팥빵, 소보루빵, 식빵, 케이크, 샌드위치","위치":"서울 동대문구","특징":"매일 아침 갓 구운 신선한 빵과 다양한 디저트를 판매하는 빵집입니다.","좌표":"290,200","url":"cosmic-choux-644e6b.netlify.app"},
                {"고유ID":118,"가게이름":"태광상회","가게분류":"가공식품","main_product":"라면, 과자, 음료수, 통조림, 생활용품","위치":"서울 동대문구","특징":"각종 식료품과 생활 잡화를 함께 판매하는 종합 소매점입니다.","좌표":"270,200","url":"boisterous-caramel-49f7bf.netlify.app"},
                {"고유ID":119,"가게이름":"영진이네","가게분류":"농산물","main_product":"사과, 배, 감자, 양파, 대파, 제철 채소","위치":"서울 동대문구","특징":"주로 신선한 채소와 과일을 취급하며, 제철 맞은 농산물을 판매합니다.","좌표":"390,65","url":"stirring-sopapillas-445477.netlify.app"},
                {"고유ID":120,"가게이름":"경희신발","가게분류":"생활용품(의류/패션)","main_product":"운동화, 슬리퍼, 구두, 장화, 등산화","위치":"서울 동대문구","특징":"편안한 신발과 의류를 저렴한 가격에 판매하는 가게입니다.","좌표":"449,100","url":"fancy-kataifi-31d49b.netlify.app"},
                {"고유ID":121,"가게이름":"동작상회","가게분류":"농산물","main_product":"상추, 깻잎, 고추, 마늘, 오이, 각종 쌈채소","위치":"서울 동대문구","특징":"다양한 종류의 신선한 농산물을 전문적으로 취급합니다.","좌표":"449,126","url":"dulcet-lily-df3899.netlify.app"},
                {"고유ID":122,"가게이름":"우리과일","가게분류":"청과물","main_product":"수박, 참외, 포도, 복숭아, 자두, 계절과일","위치":"서울 동대문구","특징":"제철을 맞은 신선하고 당도 높은 과일을 전문적으로 판매합니다.","좌표":"744,470","url":"singular-kheer-0305fe.netlify.app"},
                {"고유ID":123,"가게이름":"화장실1","가게분류":"편의시설","main_product":null,"위치":"서울 동대문구","특징":"공용시설","좌표":"414,346","url":"tourmaline-malabi-9e1207.netlify.app"},
                {"고유ID":124,"가게이름":"삼거리야채","가게분류":"농산물","main_product":"대파,무,쪽파,배추,양파,시금치,깻잎,상추","위치":"서울 동대문구 고산자로38길/다-20","특징":"다양한 채소들을 판매합니다.","좌표":"160,50","url":"dancing-beijinho-d6f976.netlify.app"},
                {"고유ID":125,"가게이름":"태우농산","가게분류":"농산물","main_product":"고추,참기름,들기름,볶은깨,고춧가루","위치":"서울 동대문구 고산자로38길/다-19","특징":"신선한 고추와 참기름을 판매합니다.","좌표":"100,107","url":"scintillating-moonbeam-61d4b4.netlify.app"},
                {"고유ID":126,"가게이름":"오복참기름","가게분류":"농산물","main_product":"고추,참기름,들기름,볶은깨,콩기름","위치":"서울 동대문구 고산자로38길/다-18","특징":"참기름을 전문으로 판매합니다.","좌표":"160,107","url":"fancy-cendol-3d1adc.netlify.app"},
                {"고유ID":127,"가게이름":"경동함흥냉면","가게분류":"음식점(한식)","main_product":"물냉면,비빔냉면,회냉면,갈비탕,수육,만두","위치":"서울 동대문구 고산자로38길/다-17","특징":"시원한 냉면을 맛볼 수 있는 곳입니다.","좌표":"100,160","url":"silly-conkies-ee7b31.netlify.app"},
                {"고유ID":128,"가게이름":"동건건어물","가게분류":"가공식품","main_product":"건어물,노가리,오징어채,쥐포,멸치,황태포,먹태,김,다시마","위치":"서울 동대문구 고산자로38길/다-16","특징":"다양한 건어물을 판매합니다.","좌표":"160,160","url":"incredible-toffee-b02bdd.netlify.app"},
                {"고유ID":129,"가게이름":"약식동원점","가게분류":"음식점(카페/음료)","main_product":"전통차,쌍화차,생강차,오미자차,대추차,유자차","위치":"서울 동대문구 고산자로38길/다-15","특징":"몸에 좋은 전통차를 판매합니다.","좌표":"100,200","url":"nimble-heliotrope-9bd12f.netlify.app"},
                {"고유ID":130,"가게이름":"일번지정육점","가게분류":"정육점","main_product":"돼지갈비,목살,삼겹살,소갈비,소고기국거리,소고기등심,한우특수부위(채끝,안심),소꼬리,돼지갈매기살","위치":"서울 동대문구 고산자로38길/다-14","특징":"다양한 부위의 고기를 판매하며, 고급 부위와 국거리용 고기를 모두 구매할 수 있습니다.","좌표":"160,200","url":"timely-froyo-ca5acb.netlify.app"},
                {"고유ID":131,"가게이름":"천일농산","가게분류":"농산물","main_product":"고추,들기름,참기름,볶은깨,쌀,잡곡,고춧가루","위치":"서울 동대문구 고산자로38길/다-13","특징":"신선한 고추와 직접 짠 들기름, 참기름을 판매합니다.","좌표":"280,43","url":"coruscating-pastelito-269f17.netlify.app"},
                {"고유ID":132,"가게이름":"춘천막국수","가게분류":"음식점(한식)","main_product":"모밀냉면,소바,막국수,비빔막국수,감자전,닭갈비","위치":"서울 동대문구 고산자로38길/다-12","특징":"시원한 막국수와 소바를 판매합니다.","좌표":"296,43","url":"peaceful-toffee-76aa7c.netlify.app"},
                {"고유ID":133,"가게이름":"그시절그맛","가게분류":"음식점(제과제빵)","main_product":"꽈배기,도너츠,찐빵,찹쌀도넛,고로케,소시지빵,맘모스빵","위치":"서울 동대문구 고산자로38길/다-11","특징":"추억의 간식인 꽈배기, 도너츠 등을 판매합니다.","좌표":"280,90","url":"stellar-valkyrie-cf0231.netlify.app"},
                {"고유ID":134,"가게이름":"경동상회","가게분류":"건강식품","main_product":"더덕,도라지,인삼,꿀,홍삼액,영지버섯,상황버섯","위치":"서울 동대문구 고산자로38길/다-10","특징":"몸에 좋은 더덕, 도라지, 인삼을 판매합니다.","좌표":"296,90","url":"heartfelt-mermaid-3bc1df.netlify.app"},
                {"고유ID":135,"가게이름":"성일식품","가게분류":"음식점(한식)","main_product":"면,칼국수,잔치국수,비빔국수,콩국수","위치":"서울 동대문구 고산자로38길/다-9","특징":"다양한 면 요리를 판매합니다.","좌표":"280,118","url":"glittery-tiramisu-b533b0.netlify.app"},
                {"고유ID":136,"가게이름":"심성땅콩","가게분류":"가공식품","main_product":"건어물,노가리,오징어채,쥐포,멸치,황태포,먹태,김,다시마","위치":"서울 동대문구 고산자로38길/다-8","특징":"건어물 전문점입니다.","좌표":"300,120","url":"peaceful-longma-246c2a.netlify.app"},
                {"고유ID":137,"가게이름":"충북보리밥집","가게분류":"음식점(한식)","main_product":"소머리국밥,보리밥,청국장,된장찌개","위치":"서울 동대문구 고산자로38길/다-7","특징":"진한 소머리국밥을 판매합니다.","좌표":"280,170","url":"loquacious-tarsier-c3189a.netlify.app"},
                {"고유ID":138,"가게이름":"양평순대국","가게분류":"음식점(한식)","main_product":"뼈해장국,순대국,감자탕,순대볶음,술국","위치":"서울 동대문구 고산자로38길/다-6","특징":"순대국 전문 식당입니다.","좌표":"300,170","url":"delicate-puppy-2eaf4a.netlify.app"},
                {"고유ID":139,"가게이름":"대광상회","가게분류":"생활용품(잡화)","main_product":"망,봉투,용기,젓가락,그릇,접시,컵,냄비,주방용품","위치":"서울 동대문구 고산자로38길/다-5","특징":"식당 용품 및 생활용품을 판매합니다.","좌표":"280,200","url":"astonishing-pegasus-d398f6.netlify.app"},
                {"고유ID":140,"가게이름":"소반술빵","가게분류":"반찬/김치","main_product":"깻잎,나물무침,배추김치,파김치,깍두기,총각김치,겉절이,콩나물무침","위치":"서울 동대문구 고산자로38길/다-4","특징":"다양한 종류의 김치와 반찬을 판매합니다.","좌표":"300,200","url":"earnest-llama-de57fd.netlify.app"},
                {"고유ID":141,"가게이름":"영심이네","가게분류":"음식점(간식/디저트)","main_product":"닭강정,닭꼬치,통닭,닭발,순살치킨","위치":"서울 동대문구 고산자로38길/다-3","특징":"바삭하고 달콤한 닭강정을 판매합니다.","좌표":"400,65","url":"fascinating-babka-2a749d.netlify.app"},
                {"고유ID":142,"가게이름":"크로바신발","가게분류":"생활용품(의류/패션)","main_product":"신발,운동화,구두,슬리퍼,샌들,등산화,장화","위치":"서울 동대문구 고산자로38길/다-2","특징":"다양한 신발을 판매합니다.","좌표":"459,100","url":"elegant-hamster-f65e0c.netlify.app"},
                {"고유ID":143,"가게이름":"풍작상회","가게분류":"농산물","main_product":"고추,쌀,잡곡,참기름,들기름,고춧가루,콩,팥,보리","위치":"서울 동대문구 고산자로38길/다-1","특징":"다양한 농산물을 판매합니다.","좌표":"459,126","url":"stirring-klepon-733ff5.netlify.app"},
                {"고유ID":144,"가게이름":"화장실1","가게분류":"편의시설","main_product":null,"위치":null,"특징":"공용 화장실입니다.","좌표":"444,346","url":"tourmaline-malabi-9e1207.netlify.app"},
                {"고유ID":145,"가게이름":"화장실2","가게분류":"편의시설","main_product":null,"위치":null,"특징":"공용 화장실입니다.","좌표":"680,30","url":"shimmering-macaron-b3333b.netlify.app"},
                {"고유ID":146,"가게이름":"양평순대국","가게분류":"음식점(한식)","main_product":"감자탕,뼈해장국,순대국,순대볶음,술국","위치":"고산자로 38번길/다-6","특징":"순대국과 뼈해장국을 판매합니다.","좌표":"300,170","url":"delicate-puppy-2eaf4a.netlify.app"},
                {"고유ID":147,"가게이름":"대광상회","가게분류":"생활용품(잡화)","main_product":"그릇,냄비,망,봉투,용기,접시,젓가락,주방용품,컵","위치":"서울 동대문구 고산자로38길/다-5","특징":"식당 용품 및 생활용품을 판매합니다.","좌표":"280,200","url":"astonishing-pegasus-d398f6.netlify.app"},
                {"고유ID":148,"가게이름":"소반술빵","가게분류":"반찬/김치","main_product":"겉절이,깍두기,깻잎,나물무침,배추김치,총각김치,콩나물무침,파김치","위치":"서울 동대문구 고산자로38길/다-4","특징":"다양한 종류의 김치와 반찬을 판매합니다.","좌표":"300,200","url":"earnest-llama-de57fd.netlify.app"},
                {"고유ID":149,"가게이름":"영심이네","가게분류":"음식점(간식/디저트)","main_product":"닭강정,닭꼬치,닭발,순살치킨,통닭","위치":"서울 동대문구 고산자로38길/다-3","특징":"바삭하고 달콤한 닭강정을 판매합니다.","좌표":"400,65","url":"fascinating-babka-2a749d.netlify.app"},
                {"고유ID":150,"가게이름":"크로바신발","가게분류":"생활용품(의류/패션)","main_product":"구두,등산화,샌들,슬리퍼,신발,운동화,장화","위치":"서울 동대문구 고산자로38길/다-2","특징":"다양한 신발을 판매합니다.","좌표":"459,100","url":"elegant-hamster-f65e0c.netlify.app"},
                {"고유ID":151,"가게이름":"풍작상회","가게분류":"농산물","main_product":"고추,고춧가루,들기름,보리,쌀,잡곡,참기름,콩,팥","위치":"서울 동대문구 고산자로38길/다-1","특징":"다양한 농산물을 판매합니다.","좌표":"459,126","url":"stirring-klepon-733ff5.netlify.app"}
            ];

            // ==================== 데이터 처리 및 앱 상태 관리 ====================
            
            // --- 카테고리 매핑 (데이터 정제 및 확장) ---
            const categoryMap = {
                '정육': { emoji: '🥩', color: 'red', keywords: ['정육점'] },
                '수산': { emoji: '🐟', color: 'blue', keywords: ['수산물'] },
                '청과/야채': { emoji: '🥬', color: 'green', keywords: ['청과물', '농산물'] },
                '반찬/김치': { emoji: '🍚', color: 'yellow', keywords: ['반찬/김치', '가공식품'] },
                '음식점': { emoji: '🍲', color: 'purple', keywords: ['음식점(한식)', '음식점(간식/디저트)', '음식점(제과제빵)', '음식점(카페/음료)'] },
                '건강식품': { emoji: '🌿', color: 'teal', keywords: ['건강식품', '한약재'] },
                '생활용품': { emoji: '🛍️', color: 'pink', keywords: ['생활용품(잡화)', '생활용품(의류/패션)', '철물'] },
                '기타': { emoji: '🏪', color: 'gray', keywords: ['서비스', '편의시설'] }
            };

            // 데이터 변환: 원본 데이터를 앱에서 사용하기 좋은 형태로 가공
            const storeData = marketData.map(store => {
                const productNames = (store.main_product || '').split(',').map(p => p.trim()).filter(Boolean);
                const mainTags = productNames.slice(0, 2).map(tag => `#${tag}`);
                
                const products = productNames.map((productName, index) => {
                    return {
                        id: `${store.고유ID}-${index}`,
                        name: productName,
                        price: Math.floor(Math.random() * (300 - 50) + 50) * 100, // 데모용 랜덤 가격
                        img: `https://placehold.co/100x100/E0E7FF/4338CA?text=${encodeURIComponent(productName.charAt(0))}`
                    };
                });

                return {
                    id: store.고유ID,
                    name: store.가게이름,
                    category: store.가게분류,
                    mainTags: mainTags,
                    rating: (Math.random() * (5.0 - 4.0) + 4.0).toFixed(1),
                    orders: Math.floor(Math.random() * 500) + 10,
                    reviews: [],
                    products: products,
                    description: store.특징,
                    url: store.url
                };
            });

            // 앱 상태 변수
            let shoppingCart = {};
            let currentCategorySort = 'default';
            let completedOrders = [];
            let favoriteStores = [];
            let userRecipes = [];
            let recentlyViewedStores = [];
            let notifications = [];

            // --- 시장 지도 URL 관리 ---
            const DEFAULT_MAP_URL = 'https://transcendent-crisp-6ebea8.netlify.app/';
            
            function getCleanUrl(url) {
                try {
                    const urlObject = new URL(url);
                    return urlObject.origin + urlObject.pathname;
                } catch (e) {
                    return url;
                }
            }

            function getStoredMapUrl() {
                const urlParam = new URLSearchParams(location.search).get('map');
                if (urlParam) return urlParam;
                return localStorage.getItem('ddmap.marketUrl') || DEFAULT_MAP_URL;
            }

            function setMarketMapUrl(url) {
                try {
                    const cleanUrl = getCleanUrl(url);
                    localStorage.setItem('ddmap.marketUrl', cleanUrl);
                    applyMarketMapUrl(cleanUrl);
                    showToast('시장 지도 URL이 성공적으로 변경되었습니다.');
                } catch (e) {
                    showMessage('올바른 URL 형식을 입력해 주세요. (예: https://example.com)');
                }
            }

            function applyMarketMapUrl(url) {
                const frame = document.getElementById('marketMapFrame');
                const newTabLink = document.getElementById('openMapNewTab');
                const loadingIndicator = document.getElementById('mapLoading');
                
                loadingIndicator.style.display = 'flex';
                frame.style.display = 'none';
                
                frame.src = 'about:blank';
                setTimeout(() => {
                    frame.src = url;
                    newTabLink.href = url;
                }, 50);
            }

            // ==================== UI 헬퍼 함수 ====================
            function showMessage(message) {
                const modal = document.createElement('div');
                modal.className = 'modal-overlay';
                modal.innerHTML = `
                    <div class="modal-content text-center">
                        <p class="text-gray-800 text-lg mb-6">${message}</p>
                        <button onclick="this.closest('.modal-overlay').remove()" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors">확인</button>
                    </div>`;
                document.getElementById('modalContainer').appendChild(modal);
            }

            function showPromptBox(title, message, callback) {
                const modal = document.createElement('div');
                modal.className = 'modal-overlay';
                modal.innerHTML = `
                    <div class="modal-content">
                        <h3 class="text-xl font-bold mb-4">${title}</h3>
                        <p class="text-gray-600 mb-4">${message}</p>
                        <input type="text" id="promptInput" value="${getStoredMapUrl()}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-4">
                        <div class="flex justify-end space-x-2">
                            <button onclick="this.closest('.modal-overlay').remove()" class="px-4 py-2 border rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">취소</button>
                            <button id="promptConfirmBtn" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">확인</button>
                        </div>
                    </div>`;
                document.getElementById('modalContainer').appendChild(modal);
                document.getElementById('promptConfirmBtn').addEventListener('click', () => {
                    const inputValue = document.getElementById('promptInput').value;
                    callback(inputValue);
                    modal.remove();
                });
            }

            function showToast(message) {
                const container = document.getElementById('toast-container');
                const toast = document.createElement('div');
                toast.className = 'toast';
                toast.textContent = message;
                container.appendChild(toast);

                setTimeout(() => {
                    toast.remove();
                }, 3000);
            }

            // ==================== 알림 기능 ====================
            function loadNotificationsFromStorage() {
                const storedNotifications = localStorage.getItem('cheongnyamri.notifications');
                notifications = storedNotifications ? JSON.parse(storedNotifications) : [];
                updateNotificationIndicator();
            }

            function saveNotificationsToStorage() {
                localStorage.setItem('cheongnyamri.notifications', JSON.stringify(notifications));
            }

            function updateNotificationIndicator() {
                const dot = document.getElementById('notification-dot');
                const hasUnread = notifications.some(n => !n.read);
                dot.classList.toggle('hidden', !hasUnread);
            }

            function showNotificationModal() {
                const modal = document.createElement('div');
                modal.className = 'modal-overlay';
                let notificationsHtml = notifications.length === 0 
                    ? `<p class="text-center text-gray-500 py-10">새로운 알림이 없습니다.</p>`
                    : notifications.map(n => `
                        <div class="p-3 border-b last:border-b-0 ${!n.read ? 'bg-indigo-50' : ''}">
                            <p class="text-sm text-gray-800">${n.message}</p>
                        </div>
                    `).join('');
                
                modal.innerHTML = `
                    <div class="modal-content flex flex-col h-full max-h-[80vh]">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">알림</h3>
                            <button onclick="this.closest('.modal-overlay').remove()"><i class="ph ph-x text-2xl"></i></button>
                        </div>
                        <div class="flex-1 overflow-y-auto -mx-6 px-6">${notificationsHtml}</div>
                    </div>`;
                
                document.getElementById('modalContainer').appendChild(modal);

                notifications.forEach(n => n.read = true);
                saveNotificationsToStorage();
                updateNotificationIndicator();
            }

            // ==================== 장바구니 기능 ====================
            // 추가: 장바구니 수량 표시 업데이트 함수
            function updateCartCountIndicator() {
                const countElement = document.getElementById('cart-item-count');
                let totalCount = 0;
                for (const storeId in shoppingCart) {
                    for (const cartItemId in shoppingCart[storeId].items) {
                        totalCount += shoppingCart[storeId].items[cartItemId].quantity;
                    }
                }
                countElement.textContent = totalCount;
                countElement.classList.toggle('hidden', totalCount === 0);
            }

            function simpleHash(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = (hash << 5) - hash + char;
                    hash &= hash; // 32비트 정수로 변환
                }
                return hash;
            }

            function showAddToCartModal(productData) {
                const modal = document.createElement('div');
                modal.className = 'modal-overlay';
                modal.innerHTML = `
                    <div class="modal-content">
                        <h3 class="text-xl font-bold mb-2">${productData.productName}</h3>
                        <p class="text-gray-600 mb-4">상품을 장바구니에 담습니다.</p>
                        <input type="text" id="itemRequestInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-4" placeholder="특별 요청사항 (예: 찌개용으로 썰어주세요)">
                        <div class="flex flex-col space-y-2">
                            <button id="confirmAddToCartBtn" class="w-full px-4 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition-colors">장바구니 담기</button>
                            <button onclick="this.closest('.modal-overlay').remove()" class="w-full px-4 py-2 border rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">취소</button>
                        </div>
                    </div>`;
                document.getElementById('modalContainer').appendChild(modal);

                document.getElementById('confirmAddToCartBtn').addEventListener('click', () => {
                    const request = document.getElementById('itemRequestInput').value.trim();
                    addToCart(
                        productData.storeId,
                        productData.storeName,
                        productData.productId,
                        productData.productName,
                        parseInt(productData.productPrice, 10),
                        productData.productImg,
                        request
                    );
                    modal.remove();
                    showToast(`'${productData.productName}' 상품을 장바구니에 담았습니다!`);
                });
            }

            function addToCart(storeId, storeName, productId, productName, price, img, request = "") {
                if (!shoppingCart[storeId]) {
                    shoppingCart[storeId] = { storeName: storeName, items: {} };
                }
                
                const cartItemId = `${productId}-${simpleHash(request)}`;

                if (shoppingCart[storeId].items[cartItemId]) {
                    shoppingCart[storeId].items[cartItemId].quantity++;
                } else {
                    shoppingCart[storeId].items[cartItemId] = {
                        productId, name: productName, price, quantity: 1, img, request
                    };
                }
                updateCartCountIndicator(); // 수량 업데이트
            }

            function updateCartItemQuantity(storeId, cartItemId, change) {
                if (shoppingCart[storeId] && shoppingCart[storeId].items[cartItemId]) {
                    const item = shoppingCart[storeId].items[cartItemId];
                    item.quantity += change;
                    if (item.quantity <= 0) {
                        delete shoppingCart[storeId].items[cartItemId];
                        if (Object.keys(shoppingCart[storeId].items).length === 0) {
                            delete shoppingCart[storeId];
                        }
                    }
                }
                updateCartCountIndicator(); // 수량 업데이트
                const existingModal = document.querySelector('.modal-overlay');
                if (existingModal) existingModal.remove();
                showCartModal();
            }

            function showCartModal() {
                const modal = document.createElement('div');
                modal.className = 'modal-overlay';
                let cartItemsHtml = '';
                let totalPrice = 0;
                const cartIsEmpty = Object.keys(shoppingCart).length === 0;

                if (cartIsEmpty) {
                    cartItemsHtml = `<p class="text-center text-gray-500 py-10">장바구니가 비어 있습니다.</p>`;
                } else {
                    for (const storeId in shoppingCart) {
                        const store = shoppingCart[storeId];
                        let storeItemsHtml = '';
                        for (const cartItemId in store.items) {
                            const item = store.items[cartItemId];
                            totalPrice += item.price * item.quantity;
                            const requestHtml = item.request ? `<p class="text-xs text-indigo-600 bg-indigo-50 rounded px-2 py-1 mt-1">요청: ${item.request}</p>` : '';
                            storeItemsHtml += `
                                <div class="flex items-start py-3 border-b last:border-b-0">
                                    <img src="${item.img}" alt="${item.name}" class="w-16 h-16 rounded-md mr-4">
                                    <div class="flex-1">
                                        <p class="font-semibold text-gray-800">${item.name}</p>
                                        <p class="text-gray-600 font-bold">${item.price.toLocaleString()}원</p>
                                        ${requestHtml}
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button class="cart-quantity-btn" data-store-id="${storeId}" data-cart-item-id="${cartItemId}" data-change="-1">-</button>
                                        <span class="w-8 text-center font-semibold">${item.quantity}</span>
                                        <button class="cart-quantity-btn" data-store-id="${storeId}" data-cart-item-id="${cartItemId}" data-change="1">+</button>
                                    </div>
                                    <button class="ml-4 text-gray-400 hover:text-red-500 cart-delete-btn" data-store-id="${storeId}" data-cart-item-id="${cartItemId}">
                                        <i class="ph ph-x-circle text-2xl"></i>
                                    </button>
                                </div>
                            `;
                        }
                        
                        cartItemsHtml += `
                            <div class="mb-4">
                                <button class="flex items-center font-bold text-lg mb-2 store-link-from-cart" data-store-id="${storeId}">
                                    ${store.storeName} <i class="ph ph-caret-right ml-1"></i>
                                </button>
                                <div class="bg-gray-50 p-2 rounded-lg">${storeItemsHtml}</div>
                            </div>
                        `;
                    }
                }

                modal.innerHTML = `
                    <div class="modal-content flex flex-col h-full max-h-[80vh]">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">장바구니</h3>
                            <button onclick="this.closest('.modal-overlay').remove()"><i class="ph ph-x text-2xl"></i></button>
                        </div>
                        <div class="flex-1 overflow-y-auto pr-2">${cartItemsHtml}</div>
                        <div class="border-t pt-4 mt-4">
                            <div class="text-right font-bold text-xl mb-4">
                                총 결제금액: <span class="text-indigo-600">${totalPrice.toLocaleString()}원</span>
                            </div>
                            <div class="flex flex-col space-y-2">
                                <button id="checkoutBtn" class="w-full px-4 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition-colors ${cartIsEmpty ? 'opacity-50 cursor-not-allowed' : ''}" ${cartIsEmpty ? 'disabled' : ''}>
                                    결제하고 픽업하기
                                </button>
                            </div>
                        </div>
                    </div>`;
                document.getElementById('modalContainer').appendChild(modal);
                
                modal.addEventListener('click', e => {
                    const quantityBtn = e.target.closest('.cart-quantity-btn');
                    const deleteBtn = e.target.closest('.cart-delete-btn');
                    const storeLink = e.target.closest('.store-link-from-cart');

                    if (quantityBtn) {
                        const { storeId, cartItemId, change } = quantityBtn.dataset;
                        updateCartItemQuantity(storeId, cartItemId, parseInt(change));
                    } else if (deleteBtn) {
                        const { storeId, cartItemId } = deleteBtn.dataset;
                        updateCartItemQuantity(storeId, cartItemId, -Infinity);
                    } else if (storeLink) {
                        const { storeId } = storeLink.dataset;
                        modal.remove();
                        showScreen('storeDetailScreen', { storeId: parseInt(storeId, 10), from: 'homeScreen' });
                    }
                });

                if (!cartIsEmpty) {
                    document.getElementById('checkoutBtn').addEventListener('click', handleCheckout);
                }
            }

            // ==================== 화면 전환 및 렌더링 ====================
            function showScreen(screenId, param = null) {
                // *** 오류 수정: 안전 코드 추가 ***
                const targetScreen = document.getElementById(screenId);
                if (!targetScreen) {
                    console.error(`showScreen: screen with id "${screenId}" not found.`);
                    return;
                }

                const appContainer = document.getElementById('appContainer');
                document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
                targetScreen.classList.add('active');

                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.screen === screenId);
                });

                if (screenId === 'mapScreen') {
                    appContainer.classList.remove('max-w-lg');
                    const storedUrl = getStoredMapUrl();
                    applyMarketMapUrl(storedUrl);
                    if (window.innerHeight > window.innerWidth) {
                        showToast("최적의 지도 경험을 위해 기기를 가로로 돌려주세요.");
                    }
                } else {
                    appContainer.classList.add('max-w-lg');
                }

                switch (screenId) {
                    case 'searchScreen': renderSearchScreen(); break;
                    case 'pickupScreen': renderPickupScreen(); break;
                    case 'myOrdersScreen': renderMyOrdersScreen(); break;
                    case 'favoritesScreen': renderFavoritesScreen(); break;
                    case 'recentStoresScreen': renderRecentStoresScreen(); break;
                    case 'categoryListScreen': if (param) renderCategoryList(param); break;
                    case 'storeDetailScreen': if (param) renderStoreDetail(param); break;
                    case 'smartShoppingScreen':
                        document.getElementById('smartSearchResultsContainer').innerHTML = '<p class="text-center text-gray-500 py-10">찾고 싶은 상품을 쉼표(,)로 구분하여 검색해 보세요.<br>또는 저장된 레시피를 이용해 보세요.</p>';
                        document.getElementById('smartSearchInput').value = '';
                        renderMyRecipes();
                        break;
                }
            }
            
            // --- 홈 화면 카테고리 바로가기 렌더링 ---
            function renderCategoryShortcuts() {
                const container = document.getElementById('category-shortcut-container');
                container.innerHTML = Object.entries(categoryMap).map(([name, { emoji, color }]) => `
                    <button onclick="showScreen('categoryListScreen', '${name}')" class="flex flex-col items-center space-y-2">
                        <div class="w-full h-16 flex items-center justify-center bg-${color}-100 rounded-lg shadow-sm text-4xl">${emoji}</div>
                        <span class="text-xs font-medium">${name}</span>
                    </button>
                `).join('');
            }

            function renderCategoryList(categoryKey) {
                const container = document.getElementById('categoryStoreListContainer');
                let stores;

                if (categoryKey === 'all') {
                    document.getElementById('categoryTitle').textContent = '전체 가게';
                    stores = [...storeData];
                } else {
                    const categoryInfo = categoryMap[categoryKey];
                    if (!categoryInfo) return;
                    document.getElementById('categoryTitle').textContent = categoryKey;
                    stores = storeData.filter(s => categoryInfo.keywords.includes(s.category));
                }
                
                container.innerHTML = '';

                switch (currentCategorySort) {
                    case 'orders': stores.sort((a, b) => b.orders - a.orders); break;
                    case 'rating': stores.sort((a, b) => b.rating - a.rating); break;
                }

                if (stores.length === 0) {
                    container.innerHTML = `<p class="text-center text-gray-500 py-10">해당 카테고리의 가게가 없습니다.</p>`;
                    return;
                }
                
                const uniqueStores = Array.from(new Map(stores.map(store => [store.id, store])).values());

                uniqueStores.forEach(store => {
                    const tagsHtml = store.mainTags.map(tag => `<span class="bg-gray-200 text-gray-700 text-xs font-medium mr-2 px-2 py-1 rounded">${tag}</span>`).join('');
                    const card = document.createElement('div');
                    card.className = 'flex items-start bg-white p-4 rounded-lg border border-gray-200 relative cursor-pointer store-link';
                    card.dataset.storeId = store.id;
                    card.dataset.from = 'categoryListScreen';
                    card.dataset.category = categoryKey; // 뒤로가기를 위해 현재 카테고리 저장
                    card.innerHTML = `
                        <img src="https://placehold.co/100x100/E0E7FF/4338CA?text=${encodeURIComponent(store.name.charAt(0))}" alt="${store.name}" class="w-24 h-24 rounded-md mr-4">
                        <div class="flex-1">
                            <h3 class="font-bold text-lg text-gray-900">${store.name}</h3>
                            <div class="flex items-center text-sm text-gray-600 mt-1">
                                <i class="ph ph-star text-yellow-400 text-base mr-1"></i>
                                <span class="font-bold">${store.rating}</span>
                                <span class="mx-1">|</span>
                                <span>리뷰 ${store.reviews.length}</span>
                            </div>
                            <div class="mt-2">${tagsHtml}</div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }

            function renderStoreDetail({ storeId, from, category }) {
                const store = storeData.find(s => s.id === storeId);
                if (!store) return;

                trackViewedStore(storeId);
                
                document.getElementById('storeDetailTitle').textContent = store.name;
                document.getElementById('backToCategoryBtn').onclick = () => showScreen(from, from === 'categoryListScreen' ? category : null);
                
                renderFavoriteButtons(storeId);

                document.getElementById('storeDetailInfo').innerHTML = `
                    <div class="flex items-center">
                        <img src="https://placehold.co/120x120/E0E7FF/4338CA?text=${encodeURIComponent(store.name.charAt(0))}" alt="${store.name}" class="w-28 h-28 rounded-lg mr-4">
                        <div>
                            <h2 class="text-2xl font-bold">${store.name}</h2>
                            <div class="flex items-center text-lg text-gray-600 mt-2">
                                <i class="ph ph-star-fill text-yellow-400 text-2xl mr-1"></i>
                                <span class="font-bold text-2xl">${store.rating}</span>
                            </div>
                            <p class="text-gray-500 mt-1">주문수 ${store.orders.toLocaleString()}</p>
                        </div>
                    </div>`;

                const productListContainer = document.getElementById('storeProductListContainer');
                productListContainer.innerHTML = '';
                if (store.products && store.products.length > 0) {
                    store.products.forEach(product => {
                        const productEl = document.createElement('div');
                        productEl.className = 'flex items-center justify-between bg-gray-50 p-4 rounded-lg';
                        productEl.innerHTML = `
                            <div class="flex items-center">
                                <img src="${product.img}" alt="${product.name}" class="w-16 h-16 rounded-md mr-4">
                                <div>
                                    <h4 class="font-semibold text-gray-800">${product.name}</h4>
                                    <p class="text-indigo-600 font-bold mt-1">${product.price.toLocaleString()}원</p>
                                </div>
                            </div>
                            <button class="add-to-cart-btn px-4 py-2 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition-colors"
                                data-store-id="${store.id}"
                                data-store-name="${store.name}"
                                data-product-id="${product.id}"
                                data-product-name="${product.name}"
                                data-product-price="${product.price}"
                                data-product-img="${product.img}">
                                담기
                            </button>`;
                        productListContainer.appendChild(productEl);
                    });
                } else {
                    productListContainer.innerHTML = `<p class="text-center text-gray-500 py-4">등록된 상품 정보가 없습니다.</p>`;
                }
                
                const reviewsContainer = document.getElementById('storeReviewsContainer');
                reviewsContainer.innerHTML = `<p class="text-center text-gray-500">아직 작성된 리뷰가 없습니다.</p>`;
            }
            
            // ==================== 검색 기능 ====================
            function renderSearchScreen() {
                const searchInput = document.getElementById('searchInput');
                searchInput.value = '';
                // 초기에는 모든 가게를 보여줍니다.
                renderSearchResults(storeData);
            }

            function navigateToStore(url) {
                if (url && url !== 'null' && url.trim() !== '') {
                    const fullUrl = url.startsWith('http') ? url : `https://${url}`;
                    window.open(fullUrl, '_blank');
                } else {
                    showMessage('길찾기 정보가 없는 상점입니다.');
                }
            }

            function renderSearchResults(stores) {
                const container = document.getElementById('searchResultsContainer');
                container.innerHTML = '';

                if (!stores || stores.length === 0) {
                    container.innerHTML = `<p class="text-center text-gray-500 mt-8">검색 결과가 없습니다.</p>`;
                    return;
                }
                
                // ID로 중복 제거
                const uniqueStores = Array.from(new Map(stores.map(store => [store.id, store])).values());

                uniqueStores.forEach(store => {
                    const storeItem = document.createElement('div');
                    storeItem.className = 'search-store-item';
                    
                    const productsList = store.products.slice(0, 5).map(p => p.name).join(', ') + (store.products.length > 5 ? '...' : '');

                    storeItem.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="text-lg font-bold text-gray-900">${store.name}</h3>
                            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded-full flex-shrink-0 ml-2">${store.category}</span>
                        </div>
                        <p class="text-sm text-gray-700 mb-2 truncate"><b>주요상품:</b> ${productsList || '정보 없음'}</p>
                        <p class="text-sm text-gray-500 mb-4">${store.description || ''}</p>
                        <div class="flex justify-end gap-2 mt-auto">
                            <button class="navigate-btn px-4 py-2 text-sm font-semibold bg-blue-500 text-white rounded-full hover:bg-blue-600" data-url="${store.url}">길찾기</button>
                            <button class="store-link px-4 py-2 text-sm font-semibold bg-orange-500 text-white rounded-full hover:bg-orange-600" data-store-id="${store.id}" data-from="searchScreen">가게보기</button>
                        </div>
                    `;
                    container.appendChild(storeItem);
                });
            }

            // ==================== 스마트 장보기 & 관심 가게 기능 ====================
            function handleSmartSearch() {
                const searchInput = document.getElementById('smartSearchInput');
                const container = document.getElementById('smartSearchResultsContainer');
                const searchTerms = searchInput.value.split(',')
                    .map(term => term.trim().split(' ')[0]) // "김치 1포기" -> "김치"
                    .filter(term => term.length > 0);

                if (searchTerms.length === 0) {
                    container.innerHTML = '<p class="text-center text-gray-500 py-10">찾고 싶은 상품을 쉼표(,)로 구분하여 검색해 보세요.<br>또는 저장된 레시피를 이용해 보세요.</p>';
                    return;
                }

                let resultsHtml = '';
                searchTerms.forEach(term => {
                    const matchingProducts = [];
                    storeData.forEach(store => {
                        store.products.forEach(product => {
                            if (product.name.toLowerCase().includes(term.toLowerCase())) {
                                matchingProducts.push({
                                    ...product,
                                    storeId: store.id,
                                    storeName: store.name,
                                    rating: store.rating,
                                    reviews: store.reviews.length
                                });
                            }
                        });
                    });

                    matchingProducts.sort((a, b) => a.price - b.price);

                    resultsHtml += `
                        <div class="border rounded-lg mb-3 overflow-hidden">
                            <button class="smart-accordion-toggle w-full p-4 text-left bg-gray-50 hover:bg-gray-100 flex justify-between items-center">
                                <span class="font-bold text-lg text-indigo-700">'${term}' 검색 결과</span>
                                <i class="ph ph-caret-down text-xl transition-transform"></i>
                            </button>
                            <div class="smart-accordion-content hidden bg-white p-4 space-y-3">
                    `;

                    if (matchingProducts.length > 0) {
                        matchingProducts.forEach(product => {
                            resultsHtml += `
                                <div class="flex items-center bg-white p-3 rounded-lg border">
                                    <div class="flex-1">
                                        <button class="font-semibold text-gray-800 hover:underline store-link" data-store-id="${product.storeId}" data-from="smartShoppingScreen">${product.storeName}</button>
                                        <div class="flex items-center text-sm text-gray-500 mt-1">
                                            <i class="ph ph-star text-yellow-400 mr-1"></i> ${product.rating}
                                            <span class="mx-2">|</span>
                                            <span class="font-bold text-indigo-600">${product.price.toLocaleString()}원</span>
                                        </div>
                                    </div>
                                    <button class="add-to-cart-btn ml-4 px-4 py-2 bg-indigo-600 text-white text-sm font-semibold rounded-lg hover:bg-indigo-700 transition-colors whitespace-nowrap"
                                        data-store-id="${product.storeId}"
                                        data-store-name="${product.storeName}"
                                        data-product-id="${product.id}"
                                        data-product-name="${product.name}"
                                        data-product-price="${product.price}"
                                        data-product-img="${product.img}">
                                        담기
                                    </button>
                                </div>
                            `;
                        });
                    } else {
                        resultsHtml += `<p class="text-center text-gray-500 py-4">'${term}'을(를) 판매하는 가게를 찾을 수 없습니다.</p>`;
                    }

                    resultsHtml += `
                            </div>
                        </div>
                    `;
                });
                container.innerHTML = resultsHtml;
            }
            
            function renderFavoriteButtons(storeId) {
                const container = document.getElementById('favoriteButtonsContainer');
                if (!container) return;

                const storeIdNum = parseInt(storeId, 10);
                const isFavorited = favoriteStores.includes(storeIdNum);

                if (isFavorited) {
                    container.innerHTML = `<button class="remove-favorite-btn text-sm font-semibold text-gray-600 bg-gray-200 px-3 py-2 rounded-lg hover:bg-gray-300" data-store-id="${storeIdNum}">관심 가게 삭제</button>`;
                } else {
                    container.innerHTML = `<button class="add-favorite-btn text-sm font-semibold text-indigo-600 bg-indigo-100 px-3 py-2 rounded-lg hover:bg-indigo-200" data-store-id="${storeIdNum}">관심 가게 등록</button>`;
                }
            }

            function toggleFavorite(storeId) {
                const storeIdNum = parseInt(storeId, 10);
                const index = favoriteStores.indexOf(storeIdNum);
                if (index > -1) {
                    favoriteStores.splice(index, 1);
                } else {
                    favoriteStores.push(storeIdNum);
                }
                
                if (document.getElementById('storeDetailScreen').classList.contains('active')) {
                    renderFavoriteButtons(storeIdNum);
                }
                
                if (document.getElementById('favoritesScreen').classList.contains('active')) {
                    renderFavoritesScreen();
                }
            }

            function renderFavoritesScreen() {
                const container = document.getElementById('favoritesScreen').querySelector('main');
                container.innerHTML = '';

                const favoriteStoreDetails = storeData.filter(store => favoriteStores.includes(store.id));

                if (favoriteStoreDetails.length === 0) {
                    container.innerHTML = `<p class="text-center text-gray-500 p-10">관심 가게가 없습니다.</p>`;
                    return;
                }

                favoriteStoreDetails.forEach(store => {
                    const tagsHtml = store.mainTags.map(tag => `<span class="bg-gray-200 text-gray-700 text-xs font-medium mr-2 px-2 py-1 rounded">${tag}</span>`).join('');
                    const card = document.createElement('div');
                    card.className = 'flex items-start bg-white p-4 rounded-lg border border-gray-200 relative cursor-pointer store-link';
                    card.dataset.storeId = store.id;
                    card.dataset.from = 'favoritesScreen';
                    card.innerHTML = `
                        <img src="https://placehold.co/100x100/E0E7FF/4338CA?text=${encodeURIComponent(store.name.charAt(0))}" alt="${store.name}" class="w-24 h-24 rounded-md mr-4">
                        <div class="flex-1">
                            <h3 class="font-bold text-lg text-gray-900">${store.name}</h3>
                            <div class="flex items-center text-sm text-gray-600 mt-1">
                                <i class="ph ph-star text-yellow-400 text-base mr-1"></i>
                                <span class="font-bold">${store.rating}</span>
                                <span class="mx-1">|</span>
                                <span>리뷰 ${store.reviews.length}</span>
                            </div>
                            <div class="mt-2">${tagsHtml}</div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }

            // ==================== 레시피 관리 기능 ====================
            function loadRecipesFromStorage() {
                const recipes = localStorage.getItem('cheongnyamri.recipes');
                userRecipes = recipes ? JSON.parse(recipes) : [];
            }

            function saveRecipesToStorage() {
                localStorage.setItem('cheongnyamri.recipes', JSON.stringify(userRecipes));
            }

            function renderMyRecipes() {
                const container = document.getElementById('myRecipesList');
                container.innerHTML = '';
                if (userRecipes.length === 0) {
                    container.innerHTML = `<p class="text-center text-sm text-gray-500 py-2">저장된 레시피가 없습니다.</p>`;
                } else {
                    userRecipes.forEach(recipe => {
                        const recipeEl = document.createElement('div');
                        recipeEl.className = 'flex justify-between items-center bg-gray-100 p-3 rounded-lg';
                        recipeEl.innerHTML = `
                            <button class="font-semibold text-left flex-1 load-recipe-btn" data-recipe-id="${recipe.id}">${recipe.name}</button>
                            <button class="edit-recipe-btn p-1 text-gray-500 hover:text-indigo-600" data-recipe-id="${recipe.id}"><i class="ph ph-pencil-simple"></i></button>
                        `;
                        container.appendChild(recipeEl);
                    });
                }
            }

            function showRecipeModal(recipeId = null) {
                showScreen('recipeModalScreen');
                const titleEl = document.getElementById('recipeModalTitle');
                const nameInput = document.getElementById('recipeNameInput');
                const idInput = document.getElementById('recipeIdInput');
                const ingredientsContainer = document.getElementById('recipeIngredientsContainer');
                const deleteBtn = document.getElementById('deleteRecipeBtn');
                
                ingredientsContainer.innerHTML = '';
                
                if (recipeId) {
                    const recipe = userRecipes.find(r => r.id === recipeId);
                    titleEl.textContent = '레시피 수정';
                    nameInput.value = recipe.name;
                    idInput.value = recipe.id;
                    recipe.ingredients.forEach(ing => addIngredientField(ing.name, ing.request));
                    deleteBtn.classList.remove('hidden');
                } else {
                    titleEl.textContent = '새 레시피 추가';
                    nameInput.value = '';
                    idInput.value = '';
                    addIngredientField(); // 시작을 위한 빈 필드 추가
                    deleteBtn.classList.add('hidden');
                }
            }

            function addIngredientField(name = '', request = '') {
                const container = document.getElementById('recipeIngredientsContainer');
                const div = document.createElement('div');
                div.className = 'flex items-center space-x-2 bg-white p-2 border rounded-lg';
                div.innerHTML = `
                    <div class="flex-1">
                        <input type="text" class="recipe-ingredient-name w-full text-sm p-1 border-b" placeholder="재료 (예: 김치 1포기)" value="${name}">
                        <input type="text" class="recipe-ingredient-request w-full text-xs p-1 text-gray-500" placeholder="요청사항 (예: 찌개용으로 썰어주세요)" value="${request}">
                    </div>
                    <button class="remove-ingredient-btn text-red-500 p-1"><i class="ph ph-trash"></i></button>
                `;
                container.appendChild(div);
            }

            function saveRecipe() {
                const recipeId = document.getElementById('recipeIdInput').value;
                const recipeName = document.getElementById('recipeNameInput').value.trim();
                if (!recipeName) {
                    showMessage('레시피 이름을 입력해주세요.');
                    return;
                }

                const ingredients = [];
                document.querySelectorAll('#recipeIngredientsContainer > div').forEach(div => {
                    const name = div.querySelector('.recipe-ingredient-name').value.trim();
                    const request = div.querySelector('.recipe-ingredient-request').value.trim();
                    if (name) {
                        ingredients.push({ name, request });
                    }
                });

                if (ingredients.length === 0) {
                    showMessage('하나 이상의 재료를 입력해주세요.');
                    return;
                }

                if (recipeId) { // 기존 레시피 수정
                    const recipeIndex = userRecipes.findIndex(r => r.id === recipeId);
                    userRecipes[recipeIndex] = { ...userRecipes[recipeIndex], name: recipeName, ingredients };
                } else { // 새 레시피 생성
                    const newRecipe = {
                        id: `recipe-${Date.now()}`,
                        name: recipeName,
                        ingredients: ingredients
                    };
                    userRecipes.push(newRecipe);
                }

                saveRecipesToStorage();
                showScreen('smartShoppingScreen');
            }
            
            function deleteRecipe() {
                const recipeId = document.getElementById('recipeIdInput').value;
                userRecipes = userRecipes.filter(r => r.id !== recipeId);
                saveRecipesToStorage();
                showScreen('smartShoppingScreen');
            }
            
            // ==================== 최근 본 가게 ====================
            function loadRecentlyViewedFromStorage() {
                const recent = localStorage.getItem('cheongnyamri.recentStores');
                recentlyViewedStores = recent ? JSON.parse(recent) : [];
            }

            function saveRecentlyViewedToStorage() {
                localStorage.setItem('cheongnyamri.recentStores', JSON.stringify(recentlyViewedStores));
            }

            function trackViewedStore(storeId) {
                recentlyViewedStores = recentlyViewedStores.filter(item => item.storeId !== storeId);
                recentlyViewedStores.unshift({ storeId: storeId, viewedAt: new Date().toISOString() });
                recentlyViewedStores = recentlyViewedStores.slice(0, 20);
                saveRecentlyViewedToStorage();
            }

            function formatRelativeDate(dateString) {
                const days = ['일', '월', '화', '수', '목', '금', '토'];
                const now = new Date();
                const viewedDate = new Date(dateString);
                
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const yesterday = new Date(today);
                yesterday.setDate(yesterday.getDate() - 1);

                if (viewedDate >= today) return '오늘';
                if (viewedDate >= yesterday) return '어제';
                
                return `${viewedDate.getMonth() + 1}월 ${viewedDate.getDate()}일 ${days[viewedDate.getDay()]}요일`;
            }

            function renderRecentStoresScreen() {
                const container = document.getElementById('recentStoresScreen').querySelector('main');
                container.innerHTML = '';

                if (recentlyViewedStores.length === 0) {
                    container.innerHTML = `<p class="text-center text-gray-500 p-10">최근 본 가게가 없습니다.</p>`;
                    return;
                }

                const groupedByDate = recentlyViewedStores.reduce((acc, item) => {
                    const dateKey = formatRelativeDate(item.viewedAt);
                    if (!acc[dateKey]) {
                        acc[dateKey] = [];
                    }
                    acc[dateKey].push(item);
                    return acc;
                }, {});

                for (const dateKey in groupedByDate) {
                    const dateHeader = document.createElement('h2');
                    dateHeader.className = 'text-md font-bold text-gray-600 pb-2 border-b';
                    dateHeader.textContent = dateKey;
                    container.appendChild(dateHeader);

                    const storesOnDate = groupedByDate[dateKey];
                    storesOnDate.forEach(({ storeId }) => {
                        const store = storeData.find(s => s.id === storeId);
                        if (!store) return;

                        const tagsHtml = store.mainTags.map(tag => `<span class="bg-gray-200 text-gray-700 text-xs font-medium mr-2 px-2 py-1 rounded">${tag}</span>`).join('');
                        const card = document.createElement('div');
                        card.className = 'flex items-start bg-white p-4 rounded-lg border border-gray-200 relative cursor-pointer store-link';
                        card.dataset.storeId = store.id;
                        card.dataset.from = 'recentStoresScreen';
                        card.innerHTML = `
                            <img src="https://placehold.co/100x100/E0E7FF/4338CA?text=${encodeURIComponent(store.name.charAt(0))}" alt="${store.name}" class="w-24 h-24 rounded-md mr-4">
                            <div class="flex-1">
                                <h3 class="font-bold text-lg text-gray-900">${store.name}</h3>
                                <div class="flex items-center text-sm text-gray-600 mt-1">
                                    <i class="ph ph-star text-yellow-400 text-base mr-1"></i>
                                    <span class="font-bold">${store.rating}</span>
                                    <span class="mx-1">|</span>
                                    <span>리뷰 ${store.reviews.length}</span>
                                </div>
                                <div class="mt-2">${tagsHtml}</div>
                            </div>
                        `;
                        container.appendChild(card);
                    });
                }
            }


            // ==================== 픽업 및 주문 내역 기능 ====================
             function handleCheckout() {
                const orderId = `CNY-${Date.now()}`;
                const date = new Date();
                let totalPrice = 0;
                
                const orderCart = JSON.parse(JSON.stringify(shoppingCart));

                for (const storeId in orderCart) {
                    for (const cartItemId in orderCart[storeId].items) {
                        const item = orderCart[storeId].items[cartItemId];
                        totalPrice += item.price * item.quantity;
                    }
                }

                const newOrder = {
                    orderId: orderId,
                    cart: orderCart,
                    date: date.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'short' }),
                    totalPrice: totalPrice
                };
                completedOrders.push(newOrder);
                
                // 알림 생성
                for (const storeId in orderCart) {
                    const store = orderCart[storeId];
                    const firstItem = Object.values(store.items)[0];
                    const totalItems = Object.keys(store.items).length;
                    const message = `'${store.storeName}'에서 ${firstItem.name}` + (totalItems > 1 ? ` 외 ${totalItems - 1}건` : '') + ` 구매가 완료되었습니다. (총 ${newOrder.totalPrice.toLocaleString()}원)`;
                    
                    const newNotification = {
                        id: Date.now() + parseInt(storeId),
                        message: message,
                        read: false
                    };
                    notifications.unshift(newNotification);
                    showToast(message);
                }
                saveNotificationsToStorage();
                updateNotificationIndicator();

                shoppingCart = {};
                updateCartCountIndicator(); // 결제 후 수량 업데이트
                
                const modal = document.querySelector('.modal-overlay');
                if (modal) modal.remove();
                
                showScreen('pickupScreen');
            }

            function renderPickupScreen() {
                const pickupScreenMain = document.getElementById('pickupScreen').querySelector('main');
                pickupScreenMain.innerHTML = '';

                if (completedOrders.length === 0) {
                    pickupScreenMain.innerHTML = `<p class="text-center text-gray-500 p-10">완료된 주문이 없습니다. 장바구니에서 결제를 먼저 진행해주세요.</p>`;
                    return;
                }

                [...completedOrders].reverse().forEach(order => {
                    const orderEl = document.createElement('div');
                    orderEl.className = 'mb-8';
                    
                    let itemsHtml = '';
                    for (const storeId in order.cart) {
                        const store = order.cart[storeId];
                        const items = Object.values(store.items).map(item => {
                            const requestText = item.request ? ` (${item.request})` : '';
                            return `${item.name} ${item.quantity}개${requestText}`;
                        }).join(', ');

                        itemsHtml += `
                            <div class="flex items-start bg-gray-100 p-3 rounded-lg">
                                <img src="https://placehold.co/48x48/E0E7FF/4338CA?text=${encodeURIComponent(store.storeName.charAt(0))}" class="w-12 h-12 rounded-md mr-4" alt="">
                                <div><p class="font-semibold text-gray-800">${store.storeName}</p><p class="text-gray-600">${items}</p></div>
                            </div>`;
                    }

                    orderEl.innerHTML = `
                        <div class="bg-gray-50 p-6 rounded-lg text-center">
                            <h2 class="text-lg font-semibold text-gray-800">픽업 준비 완료</h2>
                            <p class="text-gray-500 mt-1">픽업 센터에서 아래 QR코드를 보여주세요.</p>
                            <div id="qrcode-${order.orderId}" class="mt-4 flex justify-center"></div>
                            <p class="mt-4 text-sm font-mono bg-gray-200 p-2 rounded inline-block">주문번호: ${order.orderId}</p>
                        </div>
                        <div class="mt-8">
                            <h3 class="text-lg font-bold text-gray-800 mb-4">주문 내역</h3>
                            <div class="space-y-3">${itemsHtml}</div>
                        </div>
                        <hr class="my-8 border-gray-300">
                    `;
                    pickupScreenMain.appendChild(orderEl);

                    // *** QR 코드 생성 오류 수정 ***
                    // QRCode 생성자의 두 번째 인자는 옵션 객체여야 합니다.
                    new QRCode(document.getElementById(`qrcode-${order.orderId}`), { 
                        text: order.orderId, 
                        width: 180, 
                        height: 180 
                    });
                });
            }

            function renderMyOrdersScreen() {
                const container = document.getElementById('myOrdersScreen').querySelector('main');
                container.innerHTML = '';

                if (completedOrders.length === 0) {
                    container.innerHTML = `<p class="text-center text-gray-500 p-10">주문 내역이 없습니다.</p>`;
                    return;
                }

                [...completedOrders].reverse().forEach(order => {
                    let orderItemsHtml = '';
                    for (const storeId in order.cart) {
                        const store = order.cart[storeId];
                        const itemNames = Object.values(store.items).map(item => {
                             const requestText = item.request ? `<span class="text-xs text-indigo-600"> (${item.request})</span>` : '';
                            return `${item.name} ${item.quantity}개${requestText}`;
                        }).join('<br>');
                         orderItemsHtml += `
                            <div class="mt-2">
                                <h4 class="font-semibold text-lg text-gray-800">${store.storeName}</h4>
                                <p class="text-gray-600 pl-1">${itemNames}</p>
                            </div>
                        `;
                    }

                    const orderCard = document.createElement('div');
                    orderCard.className = 'bg-white p-4 rounded-lg border border-gray-200 shadow-sm';
                    orderCard.innerHTML = `
                        <p class="text-sm text-gray-500 mb-2">${order.date} - 픽업</p>
                        ${orderItemsHtml}
                        <div class="border-t mt-4 pt-3 flex justify-between items-center">
                            <span class="font-semibold text-gray-700">결제금액</span>
                            <span class="font-bold text-lg text-gray-900">${order.totalPrice.toLocaleString()}원</span>
                        </div>
                    `;
                    container.appendChild(orderCard);
                });
            }
            
            // ==================== 이벤트 리스너 설정 ====================
            function setupAllEventListeners() {
                // 검색 페이지의 검색 입력 이벤트
                document.getElementById('searchInput').addEventListener('input', (e) => {
                    const query = e.target.value.toLowerCase().trim().replace(/\s/g, '');
                    if (query === "") {
                        renderSearchResults(storeData);
                        return;
                    }
                    const filteredStores = storeData.filter(store => {
                        const storeName = (store.name || '').toLowerCase().replace(/\s/g, '');
                        const products = store.products.map(p => p.name).join('').toLowerCase().replace(/\s/g, '');
                        const description = (store.description || '').toLowerCase().replace(/\s/g, '');
                        return storeName.includes(query) || products.includes(query) || description.includes(query);
                    });
                    renderSearchResults(filteredStores);
                });

                document.getElementById('smartSearchInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handleSmartSearch();
                    }
                });

                document.querySelectorAll('.category-sort-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        document.querySelectorAll('.category-sort-btn').forEach(btn => btn.classList.remove('filter-active'));
                        e.currentTarget.classList.add('filter-active');
                        currentCategorySort = e.currentTarget.dataset.sort;
                        const currentCategory = document.getElementById('categoryTitle').textContent;
                        const categoryKey = Object.keys(categoryMap).find(key => categoryMap[key].keywords.includes(currentCategory)) || (currentCategory === '전체 가게' ? 'all' : null);
                        renderCategoryList(categoryKey || currentCategory);
                    });
                });
                
                document.getElementById('addIngredientBtn').addEventListener('click', () => addIngredientField());
                document.getElementById('saveRecipeBtn').addEventListener('click', saveRecipe);
                document.getElementById('deleteRecipeBtn').addEventListener('click', deleteRecipe);
                document.getElementById('recipeIngredientsContainer').addEventListener('click', e => {
                    if (e.target.closest('.remove-ingredient-btn')) {
                        e.target.closest('.flex').remove();
                    }
                });

                document.body.addEventListener('click', (e) => {
                    const addToCartBtn = e.target.closest('.add-to-cart-btn');
                    const addFavoriteBtn = e.target.closest('.add-favorite-btn');
                    const removeFavoriteBtn = e.target.closest('.remove-favorite-btn');
                    const storeLink = e.target.closest('.store-link');
                    const navigateBtn = e.target.closest('.navigate-btn');
                    const accordionToggle = e.target.closest('.smart-accordion-toggle');
                    const loadRecipeBtn = e.target.closest('.load-recipe-btn');
                    const editRecipeBtn = e.target.closest('.edit-recipe-btn');

                    if (addToCartBtn) {
                        showAddToCartModal(addToCartBtn.dataset);
                    } else if (addFavoriteBtn) {
                        toggleFavorite(addFavoriteBtn.dataset.storeId);
                    } else if (removeFavoriteBtn) {
                        toggleFavorite(removeFavoriteBtn.dataset.storeId);
                    } else if (storeLink) {
                         showScreen('storeDetailScreen', { 
                            storeId: parseInt(storeLink.dataset.storeId, 10), 
                            from: storeLink.dataset.from,
                            category: storeLink.dataset.category // 카테고리 정보 전달
                        });
                    } else if (navigateBtn) {
                        navigateToStore(navigateBtn.dataset.url);
                    } else if (accordionToggle) {
                        const content = accordionToggle.nextElementSibling;
                        const icon = accordionToggle.querySelector('i');
                        content.classList.toggle('hidden');
                        icon.classList.toggle('rotate-180');
                    } else if (loadRecipeBtn) {
                        const recipeId = loadRecipeBtn.dataset.recipeId;
                        const recipe = userRecipes.find(r => r.id === recipeId);
                        const ingredientNames = recipe.ingredients.map(i => i.name).join(', ');
                        document.getElementById('smartSearchInput').value = ingredientNames;
                        handleSmartSearch();
                    } else if (editRecipeBtn) {
                        showRecipeModal(editRecipeBtn.dataset.recipeId);
                    }
                });

                // *** 오류 수정: 이벤트 리스너 수정 ***
                document.querySelectorAll('.nav-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const screenId = e.currentTarget.dataset.screen;
                        // data-screen 속성이 있는 버튼만 화면 전환을 실행합니다.
                        // 이렇게 하면 onclick이 지정된 장바구니 버튼과의 충돌을 피할 수 있습니다.
                        if (screenId) {
                            showScreen(screenId);
                        }
                    });
                });

                const frame = document.getElementById('marketMapFrame');
                frame.addEventListener('load', () => {
                    document.getElementById('mapLoading').style.display = 'none';
                    frame.style.display = 'block';
                });
            }
            
            // ==================== 앱 초기화 ====================
            document.addEventListener('DOMContentLoaded', () => {
                loadRecipesFromStorage();
                loadRecentlyViewedFromStorage();
                loadNotificationsFromStorage();
                renderCategoryShortcuts(); // 홈 화면 카테고리 렌더링
                setupAllEventListeners();
                updateCartCountIndicator(); // 앱 시작 시 카운트 초기화
                showScreen('homeScreen');
            });

            // 전역 스코프에 함수 노출
            window.showScreen = showScreen;
            window.showCartModal = showCartModal;
            window.showNotificationModal = showNotificationModal;
            window.showRecipeModal = showRecipeModal;
            window.showPromptBox = showPromptBox;
            window.setMarketMapUrl = setMarketMapUrl;
        })();
    </script>
</body>
</html>
